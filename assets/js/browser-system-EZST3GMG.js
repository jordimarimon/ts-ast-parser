import{a as n,b as d,c as b,d as a}from"./chunk-JGZNYISH.js";import{c as u,d as h}from"./chunk-X5OQPEMW.js";var r=u(h(),1),p=["lib.d.ts","lib.decorators.d.ts","lib.decorators.legacy.d.ts","lib.dom.d.ts","lib.dom.iterable.d.ts","lib.es2015.collection.d.ts","lib.es2015.core.d.ts","lib.es2015.d.ts","lib.es2015.generator.d.ts","lib.es2015.iterable.d.ts","lib.es2015.promise.d.ts","lib.es2015.proxy.d.ts","lib.es2015.reflect.d.ts","lib.es2015.symbol.d.ts","lib.es2015.symbol.wellknown.d.ts","lib.es2016.array.include.d.ts","lib.es2016.d.ts","lib.es2016.full.d.ts","lib.es2017.d.ts","lib.es2017.full.d.ts","lib.es2017.intl.d.ts","lib.es2017.object.d.ts","lib.es2017.sharedmemory.d.ts","lib.es2017.string.d.ts","lib.es2017.typedarrays.d.ts","lib.es2018.asyncgenerator.d.ts","lib.es2018.asynciterable.d.ts","lib.es2018.d.ts","lib.es2018.full.d.ts","lib.es2018.intl.d.ts","lib.es2018.promise.d.ts","lib.es2018.regexp.d.ts","lib.es2019.array.d.ts","lib.es2019.d.ts","lib.es2019.full.d.ts","lib.es2019.intl.d.ts","lib.es2019.object.d.ts","lib.es2019.string.d.ts","lib.es2019.symbol.d.ts","lib.es2020.bigint.d.ts","lib.es2020.d.ts","lib.es2020.date.d.ts","lib.es2020.full.d.ts","lib.es2020.intl.d.ts","lib.es2020.number.d.ts","lib.es2020.promise.d.ts","lib.es2020.sharedmemory.d.ts","lib.es2020.string.d.ts","lib.es2020.symbol.wellknown.d.ts","lib.es2021.d.ts","lib.es2021.full.d.ts","lib.es2021.intl.d.ts","lib.es2021.promise.d.ts","lib.es2021.string.d.ts","lib.es2021.weakref.d.ts","lib.es2022.array.d.ts","lib.es2022.d.ts","lib.es2022.error.d.ts","lib.es2022.full.d.ts","lib.es2022.intl.d.ts","lib.es2022.object.d.ts","lib.es2022.regexp.d.ts","lib.es2022.sharedmemory.d.ts","lib.es2022.string.d.ts","lib.es2023.array.d.ts","lib.es2023.d.ts","lib.es2023.full.d.ts","lib.es5.d.ts","lib.es6.d.ts","lib.esnext.d.ts","lib.esnext.full.d.ts","lib.esnext.intl.d.ts","lib.scripthost.d.ts","lib.webworker.d.ts","lib.webworker.importscripts.d.ts","lib.webworker.iterable.d.ts"],c=class m{constructor(s={}){this._options={},this._options=s,this._sys=b(s?.fsMap??new Map),this._commandLine=this._createCommandLine();let t=a(this._sys,this._commandLine.options,r.default);this._host=t.compilerHost,this._updateFile=t.updateFile}static async create(s={}){let t=new m(s);return await t._createDefaultMapFromCDN(r.default.version),t}getSystem(){return this._sys}getCompilerHost(){return this._host}getCommandLine(){return this._commandLine}getCurrentDirectory(){return this._host.getCurrentDirectory()}fileExists(s){return this._host.fileExists(s)}readFile(s){return this._host.readFile(s)??""}writeFile(s,t){if(!this._host.fileExists(s)){this._host.writeFile(s,t,!1),this._commandLine=this._createCommandLine();return}let l=this._commandLine.options.target??r.default.ScriptTarget.ES2022,e=this._host.getSourceFile(s,l),o={span:{start:0,length:e.text.length},newLength:t.length},i=e.update(t,o);this._updateFile(i)}normalizePath(s){return s?.startsWith("/")?(s??"").slice(1):s??""}getAbsolutePath(s){return s?.startsWith("/")?s??"":`/${s??""}`}getDirName(s){return s.split("/").slice(0,-1).join("/")}join(...s){return s.join("/")}_createDefaultMapFromCDN(s){let t=`https://typescript.azureedge.net/cdn/${s}/typescript/lib/`,l=[];for(let e of p){let o=fetch(t+e).then(i=>i.text()).then(i=>this.writeFile(`/${e}`,i)).catch(i=>console.error(i));l.push(o)}return Promise.all(l)}_createCommandLine(){let{compilerOptions:s,jsProject:t,include:l,exclude:e}=this._options.analyserOptions??{};return r.default.parseJsonConfigFileContent({compilerOptions:t?d:s??n,include:l??(t?["**/*.js"]:["**/*.ts"]),exclude:e??["**node_modules**"]},this._sys,"/")}};export{c as BrowserSystem};
