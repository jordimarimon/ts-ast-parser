import{c as u,d}from"./chunk-X5OQPEMW.js";var pt=u(d(),1),Fe=typeof document=="object"&&!!document,ft=class{constructor(t,r,i,n){this._reflectedNodesBySymbol=new Map,this._system=t,this._program=r,this._diagnostics=i,this._options=n}getProgram(){return this._program}getTypeChecker(){return this._program.getTypeChecker()}getSystem(){return this._system}getDiagnostics(){return this._diagnostics}getOptions(){return this._options}upsertFile(t,r){return this._system.writeFile(t,r),this._program=pt.default.createProgram({rootNames:this._system.getCommandLine().fileNames,options:this._program.getCompilerOptions(),host:this._system.getCompilerHost(),oldProgram:this._program,projectReferences:this._program.getProjectReferences()??[]}),this._program.getSourceFile(t)}registerReflectedNode(t,r){let i=this.getSymbol(t);if(!i)return r();let n=this._reflectedNodesBySymbol.get(i);return n||(n=r(),this._reflectedNodesBySymbol.set(i,n)),n}getSymbol(t){let r=this.getTypeChecker(),i=r.getSymbolAtLocation(t);for(!i&&this._isNamedNode(t)&&(i=r.getSymbolAtLocation(t.name));i&&i.flags&pt.default.SymbolFlags.Alias;)i=r.getAliasedSymbol(i);return i||(i=t.symbol),i??null}getLocation(t){let r;"kind"in t?r=this.getSymbol(t):r=t.aliasSymbol??t.getSymbol();let i=r?.getDeclarations()?.[0],n=i?.getSourceFile(),s=this._system.normalizePath(n?.fileName),a=i?this.getLinePosition(i):null;return{symbol:r,path:s,line:a}}getLinePosition(t){return t.getSourceFile().getLineAndCharacterOfPosition(t.getStart()).line+1}_isNamedNode(t){let r=t.name;return!!r&&(pt.default.isMemberName(r)||pt.default.isComputedPropertyName(r))}};var mt=u(d(),1),yt=class{constructor(t){this._diagnostics=[],this._argumentErrors=[],this._cwd=t}formatDiagnostics(){let t={getCanonicalFileName:r=>r,getCurrentDirectory:()=>this._cwd,getNewLine:()=>`
`};return mt.default.formatDiagnosticsWithColorAndContext(this._diagnostics,t)}getAll(){return[...this._argumentErrors,...mt.default.sortAndDeduplicateDiagnostics(this._diagnostics)]}isEmpty(){return!this._diagnostics.length}flattenMessage(t){return mt.default.flattenDiagnosticMessageText(t.messageText,`
`)}addDiagnostic(t,r){let i={file:t.getSourceFile(),start:t.getStart(),length:t.getWidth(),category:mt.default.DiagnosticCategory.Error,messageText:r,code:1e6};this._diagnostics.push(i)}addArgumentError(t){this._argumentErrors.push({messageText:t})}addManyDiagnostics(t){this._diagnostics.push(...t)}};var de=u(d(),1),_t=()=>typeof de.default.canHaveDecorators=="function"&&typeof de.default.canHaveModifiers=="function";var he=u(d(),1);function lt(e){return _t()?he.default.canHaveModifiers(e)?he.default.getModifiers(e)??[]:[]:Array.from(e.modifiers??[])}var ge=u(d(),1);function Ie(e){return lt(e).some(t=>t.kind===ge.default.SyntaxKind.ExportKeyword)}function Le(e){return lt(e).some(t=>t.kind===ge.default.SyntaxKind.DefaultKeyword)}var b;(function(e){e.Default="Default",e.Namespace="Namespace",e.Star="Star",e.Named="Named",e.Equals="Equals"})(b||(b={}));var g;(function(e){e.Import="Import",e.Declaration="Declaration",e.Export="Export"})(g||(g={}));var ut=class{constructor(t,r,i){this._declaration=null,this._node=t,this._declaration=i??null,this._context=r}getName(){return this._declaration?this._declaration.name.getText()??"":this._node.name?.getText()??""}getFullyQualifiedName(){let t=this._declaration??this._node,r=this._context.getSymbol(t);return r?this._context.getTypeChecker().getFullyQualifiedName(r).split(".").slice(1).join("."):this.getName()}getOriginalName(){return this.getName()}getNodeType(){return g.Export}getContext(){return this._context}getKind(){return Le(this._node)?b.Default:b.Named}getTSNode(){return this._node}serialize(){return{name:this.getFullyQualifiedName(),kind:this.getKind()}}};var xt=class{constructor(t,r){this._node=t,this._context=r}getName(){return this._node.expression.getText()??""}getOriginalName(){return this.getName()}getNodeType(){return g.Export}getContext(){return this._context}getKind(){return this._node.isExportEquals?b.Equals:b.Default}isTypeOnly(){return!1}getTSNode(){return this._node}serialize(){return{name:this.getName(),kind:this.getKind()}}};function o(e,t,r){e==null||r==null||(typeof r=="boolean"?r&&(e[t]=r):typeof r=="string"?r!==""&&(e[t]=r):Array.isArray(r)?r.length&&(e[t]=r):Pr(r)?Object.keys(r).length&&(e[t]=r):e[t]=r)}function Pr(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}var ve=u(d(),1),Tt=class{constructor(t,r){this._node=t,this._context=r}getName(){return!this._node.exportClause||!ve.default.isNamespaceExport(this._node.exportClause)?"":this._node.exportClause.name.escapedText??""}getOriginalName(){return this.getName()}getContext(){return this._context}getKind(){return b.Namespace}getNodeType(){return g.Export}getModule(){return this._node.moduleSpecifier?.getText()??""}getTSNode(){return this._node}isTypeOnly(){return!!this._node.isTypeOnly}serialize(){let t={name:this.getName(),kind:this.getKind()};return o(t,"module",this.getModule()),o(t,"typeOnly",this.isTypeOnly()),t}};var Nt=class{constructor(t,r,i){this._node=t,this._element=r,this._context=i}getName(){return this._element.name.escapedText??""}getOriginalName(){return this._element.propertyName?.escapedText??this.getName()}getKind(){return b.Named}getNodeType(){return g.Export}getContext(){return this._context}isTypeOnly(){return!!this._node.isTypeOnly}getModule(){return this._node.moduleSpecifier?.getText()??""}getTSNode(){return this._node}isReexport(){return this.getOriginalName()!==this.getName()}serialize(){let t=this.getOriginalName(),r={name:this.getName(),kind:this.getKind()};return t!==r.name&&o(r,"originalName",this.getOriginalName()),o(r,"typeOnly",this.isTypeOnly()),o(r,"module",this.getModule()),r}};var St=class{constructor(t,r){this._node=t,this._context=r}getName(){return"*"}getOriginalName(){return this.getName()}getKind(){return b.Star}getNodeType(){return g.Export}getContext(){return this._context}getModule(){return this._node.moduleSpecifier?.getText()??""}getTSNode(){return this._node}isTypeOnly(){return!!this._node.isTypeOnly}serialize(){let t={name:this.getName(),kind:this.getKind()};return o(t,"module",this.getModule()),o(t,"typeOnly",this.isTypeOnly()),t}};var E=u(d(),1),Re={isNode:e=>Ie(e),create:(e,t)=>{let r=[];if(E.default.isVariableStatement(e))for(let i of e.declarationList.declarations)r.push(new ut(e,t,i));return(E.default.isFunctionDeclaration(e)||E.default.isClassDeclaration(e)||E.default.isInterfaceDeclaration(e)||E.default.isEnumDeclaration(e)||E.default.isTypeAliasDeclaration(e))&&r.push(new ut(e,t)),r}},Ve={isNode:e=>E.default.isExportAssignment(e),create:(e,t)=>[new xt(e,t)]},Je={isNode:e=>E.default.isExportDeclaration(e),create:(e,t)=>{let r=e.exportClause&&E.default.isNamedExports(e.exportClause),i=e.exportClause&&E.default.isNamespaceExport(e.exportClause),n=e.moduleSpecifier!==void 0,s=[];if(r)for(let a of e.exportClause.elements)s.push(new Nt(e,a,t));else i?s.push(new Tt(e,t)):n&&s.push(new St(e,t));return s}};var x;(function(e){e.Class="Class",e.Interface="Interface",e.Function="Function",e.Mixin="Mixin",e.Variable="Variable",e.Enum="Enum",e.TypeAlias="TypeAlias"})(x||(x={}));var c;(function(e){e.Array="Array",e.Union="Union",e.Intersection="Intersection",e.ObjectLiteral="ObjectLiteral",e.Conditional="Conditional",e.Reference="Reference",e.Intrinsic="Intrinsic",e.Tuple="Tuple",e.NamedTupleMember="NamedTupleMember",e.Operator="Operator",e.Unknown="Unknown",e.IndexAccess="IndexAccess",e.Literal="Literal",e.Function="Function",e.Query="Query",e.Infer="Infer",e.Mapped="Mapped",e.Optional="Optional",e.Predicate="Predicate",e.Rest="Rest",e.TemplateLiteral="TemplateLiteral"})(c||(c={}));var bt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.TemplateLiteral}getText(){return this._context.getTypeChecker().typeToString(this._type)}serialize(){return{text:this.getText(),kind:this.getKind()}}};var Be=e=>Array.isArray(e)&&e.length>0;var fe=u(d(),1);function U(e){return!!e.replace(/'/g,"")[0]?.match(/[@a-zA-Z\d]/g)}function K(e){return e.length<1e3&&(/.*node_modules\/.+/.test(e)||/^https?:\/\/.+/.test(e))}function Y(e,t){if(!e)return"";let n=t.getSymbol(e)?.declarations?.[0]?.getSourceFile().fileName??"";return t.getSystem().normalizePath(n)}function tt(e,t){let r=t.paths??{};for(let i in r){let n=new RegExp(i);if(e.length<1e3&&n.test(e))return!0}return!1}function We(e){return!!e.importClause?.name}function ye(e){let t=e.importClause?.namedBindings;return!t||!fe.default.isNamedImports(t)?!1:Be(t.elements)}function Ue(e){let t=e.importClause?.namedBindings;return!t||!fe.default.isNamespaceImport(t)?!1:!!t.name&&!ye(e)}function $e(e){return Object.prototype.hasOwnProperty.call(e,"importClause")&&e.importClause==null}var He=u(d(),1),Dt=class{constructor(t,r,i){this._loc=null,this._node=t,this._type=r,this._context=i,He.default.isTypeReferenceNode(t.objectType)&&(this._loc=i.getLocation(t.objectType.typeName))}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.IndexAccess}getText(){return`${this.getObjectType().getText()}[${this.getIndexType().getText()}]`}getPath(){return this._loc?.path??""}getLine(){return this._loc?.line??null}getObjectType(){return m(this._node.objectType,this._context)}getIndexType(){return m(this._node.indexType,this._context)}serialize(){let t={text:this.getText(),kind:this.getKind()},r={},i=this.getPath(),n=this.getLine();return n!=null&&!K(i)&&(r.line=n,r.path=i),o(t,"source",r),t}};var Pt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.NamedTupleMember}getText(){return`${this.getName()}: ${this.getType().getText()}`}getName(){return this._node.name.getText()??""}getType(){return m(this._node.type,this._context)}isOptional(){return!!this._node.questionToken}serialize(){let t={name:this.getName(),...this.getType().serialize()};return o(t,"optional",this.isOptional()),t}};var Kt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Intersection}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getElements(){return this._node.types.map(t=>m(t,this._context))}serialize(){return{text:this.getText(),kind:this.getKind(),elements:this.getElements().map(t=>t.serialize())}}};var wt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Conditional}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getCheckType(){return m(this._node.checkType,this._context)}getExtendsType(){return m(this._node.extendsType,this._context)}getTrueType(){return m(this._node.trueType,this._context)}getFalseType(){return m(this._node.falseType,this._context)}serialize(){return{text:this.getText(),kind:this.getKind()}}};var v=u(d(),1),O=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Intrinsic}getText(){switch(this._node.kind){case v.default.SyntaxKind.NumberKeyword:return"number";case v.default.SyntaxKind.BooleanKeyword:return"boolean";case v.default.SyntaxKind.StringKeyword:return"string";case v.default.SyntaxKind.UndefinedKeyword:return"undefined";case v.default.SyntaxKind.NullKeyword:return"null";case v.default.SyntaxKind.ObjectKeyword:return"object";case v.default.SyntaxKind.SymbolKeyword:return"symbol";case v.default.SyntaxKind.BigIntKeyword:return"bigint";case v.default.SyntaxKind.VoidKeyword:return"void";default:return this._context.getTypeChecker().typeToString(this._type)??""}}serialize(){return{text:this.getText(),kind:this.getKind()}}};var _e=u(d(),1),Ct=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i,this._loc=i.getLocation(t.typeName)}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Reference}getText(){if(!(this._type.flags&_e.default.TypeFlags.Any))return this._context.getTypeChecker().typeToString(this._type);let t=_e.default.isIdentifier(this._node.typeName)?this._node.typeName.text:this._node.typeName.right.text,r=this.getTypeArguments().map(i=>i.getText());return r.length>0?`${t}<${r.join(", ")}>`:t}getPath(){return this._loc.path}getLine(){return this._loc.line}getTypeArguments(){return(this._node.typeArguments??[]).map(t=>m(t,this._context))}serialize(){let t={text:this.getText(),kind:this.getKind()},r={},i=this.getPath(),n=this.getLine();return!K(i)&&n!=null&&(r.line=n,r.path=i),o(t,"source",r),o(t,"typeArguments",this.getTypeArguments().map(s=>s.serialize())),t}};var Qe=u(d(),1),Ot=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Predicate}getText(){let t=Qe.default.isThisTypeNode(this._node.parameterName)?"this":this._node.parameterName.getText(),r=this.asserts()?["asserts",t]:[t],i=this.getTargetType();return i&&r.push("is",i.getText()),r.join(" ")}getTargetType(){return this._node.type?m(this._node.type,this._context):null}asserts(){return!!this._node.assertsModifier}serialize(){return{text:this.getText(),kind:this.getKind()}}};var zt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Operator}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getElementType(){return m(this._node.type,this._context)}serialize(){return{text:this.getText(),kind:this.getKind(),elementType:this.getElementType().serialize()}}};var N=u(d(),1);function z(e,t){let r=e;if(r==null)return;if((N.default.isAsExpression(r)||N.default.isTypeAssertionExpression(r)||N.default.isParenthesizedExpression(r)||N.default.isComputedPropertyName(r))&&(r=r.expression),N.default.isPrefixUnaryExpression(r))return Or(r,t);if(r==null)return;let i=r.getText()??"";if(N.default.isStringLiteralLike(r)||N.default.isArrayLiteralExpression(r)||N.default.isObjectLiteralExpression(r))return i;if(N.default.isNumericLiteral(r))return wr(i);if(Kr(r))return i==="true";if(r.kind===N.default.SyntaxKind.NullKeyword)return null;if(r.kind!==N.default.SyntaxKind.UndefinedKeyword)return N.default.isIdentifier(r)||N.default.isPropertyAccessExpression(r)?Cr(r,t):i}function Kr(e){return e.kind===N.default.SyntaxKind.FalseKeyword||e.kind===N.default.SyntaxKind.TrueKeyword}function wr(e){let t=parseFloat(e);return isNaN(t)?e:t}function Cr(e,t){let r=t.getSymbol(e),i=e.getText()??"",n=r?.declarations?.[0],s=n?.getSourceFile().fileName??"";return n==null||K(s)?i:N.default.isVariableDeclaration(n)||N.default.isPropertyDeclaration(n)?z(n.initializer,t):i}function Or(e,t){let r=z(e.operand,t);if(typeof r!="number"&&typeof r!="string"&&typeof r!="boolean")return r;switch(e.operator){case N.default.SyntaxKind.MinusToken:return-r;case N.default.SyntaxKind.ExclamationToken:return!r;case N.default.SyntaxKind.PlusToken:return+r;default:return r}}var Mt=class{constructor(t,r){this._node=t,this._context=r}getTSNode(){return this._node}getContext(){return this._context}getName(){return this._node.name.getText()||""}getDefault(){return z(this._node.initializer,this._context)}serialize(){let t={name:this.getName()};return o(t,"default",this.getDefault()),t}};var xe=u(d(),1);function M(e){let t;return _t()?t=xe.default.canHaveDecorators(e)?xe.default.getDecorators(e)??[]:[]:t=e.decorators??[],t}var kt=class{constructor(t,r){this._kind=t,this._jsDocTagValue=r}getKind(){return this._kind}getName(){return typeof this._jsDocTagValue=="string"||typeof this._jsDocTagValue=="boolean"?"":this._jsDocTagValue.name??""}getDescription(){return typeof this._jsDocTagValue=="string"?this._jsDocTagValue:typeof this._jsDocTagValue=="boolean"?"":this._jsDocTagValue.description??""}getType(){return typeof this._jsDocTagValue=="string"||typeof this._jsDocTagValue=="boolean"?"":this._jsDocTagValue.type??""}getDefault(){return typeof this._jsDocTagValue=="string"||typeof this._jsDocTagValue=="boolean"?"":this._jsDocTagValue.default??""}isOptional(){return typeof this._jsDocTagValue=="string"||typeof this._jsDocTagValue=="boolean"?!1:!!this._jsDocTagValue.optional}serialize(){return this._jsDocTagValue}};var w;(function(e){e.description="description",e.param="param",e.returns="returns",e.type="type",e.summary="summary",e.default="default",e.readonly="readonly",e.deprecated="deprecated",e.example="example",e.override="override",e.overview="overview",e.license="license",e.see="see",e.since="since",e.throws="throws",e.public="public",e.protected="protected",e.private="private",e.internal="internal",e.ignore="ignore",e.category="category",e.typedef="typedef",e.typeParam="typeParam",e.version="version",e.exception="exception",e.kind="kind",e.author="author",e.reflect="reflect",e.cssprop="cssprop",e.cssproperty="cssproperty",e.csspart="csspart",e.slot="slot",e.attr="attr",e.fires="fires",e.event="event",e.tag="tag",e.tagname="tagname"})(w||(w={}));var k;(function(e){e.start="/**",e.nostart="/***",e.delim="*",e.end="*/"})(k=k||(k={}));function Te(e){return/^\s+$/.test(e)}function qe(e){let t=e.match(/\r+$/);return t==null?["",e]:[e.slice(-t[0].length),e.slice(0,-t[0].length)]}function J(e){let t=e.match(/^\s+/);return t==null?["",e]:[e.slice(0,t[0].length),e.slice(t[0].length)]}function Ge(e){return e.split(/\n/)}function Ze(e={}){return Object.assign({tag:"",name:"",type:"",optional:!1,description:"",problems:[],source:[]},e)}function Ne(e={}){return Object.assign({start:"",delimiter:"",postDelimiter:"",tag:"",postTag:"",name:"",postName:"",type:"",postType:"",description:"",end:"",lineEnd:""},e)}var zr=/^@\S+/;function Se({fence:e="```"}={}){let t=Mr(e),r=(i,n)=>t(i)?!n:n;return function(n){let s=[[]],a=!1;for(let p of n)zr.test(p.tokens.description)&&!a?s.push([p]):s[s.length-1].push(p),a=r(p.tokens.description,a);return s}}function Mr(e){return typeof e=="string"?t=>t.split(e).length%2===0:e}function be({startLine:e=0,markers:t=k}={}){let r=null,i=e;return function(s){let a=s,p=Ne();if([p.lineEnd,a]=qe(a),[p.start,a]=J(a),r===null&&a.startsWith(t.start)&&!a.startsWith(t.nostart)&&(r=[],p.delimiter=a.slice(0,t.start.length),a=a.slice(t.start.length),[p.postDelimiter,a]=J(a)),r===null)return i++,null;let l=a.trimRight().endsWith(t.end);if(p.delimiter===""&&a.startsWith(t.delim)&&!a.startsWith(t.end)&&(p.delimiter=t.delim,a=a.slice(t.delim.length),[p.postDelimiter,a]=J(a)),l){let T=a.trimRight();p.end=a.slice(T.length-t.end.length),a=T.slice(0,-t.end.length)}if(p.description=a,r.push({number:i,source:s,tokens:p}),i++,l){let T=r.slice();return r=null,T}return null}}function De({tokenizers:e}){return function(r){var i;let n=Ze({source:r});for(let s of e)if(n=s(n),!((i=n.problems[n.problems.length-1])===null||i===void 0)&&i.critical)break;return n}}function jt(){return e=>{let{tokens:t}=e.source[0],r=t.description.match(/\s*(@(\S+))(\s*)/);return r===null?(e.problems.push({code:"spec:tag:prefix",message:'tag should start with "@" symbol',line:e.source[0].number,critical:!0}),e):(t.tag=r[1],t.postTag=r[3],t.description=t.description.slice(r[0].length),e.tag=r[2],e)}}function At(e="compact"){let t=jr(e);return r=>{let i=0,n=[];for(let[p,{tokens:l}]of r.source.entries()){let T="";if(p===0&&l.description[0]!=="{")return r;for(let D of l.description)if(D==="{"&&i++,D==="}"&&i--,T+=D,i===0)break;if(n.push([l,T]),i===0)break}if(i!==0)return r.problems.push({code:"spec:type:unpaired-curlies",message:"unpaired curlies",line:r.source[0].number,critical:!0}),r;let s=[],a=n[0][0].postDelimiter.length;for(let[p,[l,T]]of n.entries())l.type=T,p>0&&(l.type=l.postDelimiter.slice(a)+T,l.postDelimiter=l.postDelimiter.slice(0,a)),[l.postType,l.description]=J(l.description.slice(T.length)),s.push(l.type);return s[0]=s[0].slice(1),s[s.length-1]=s[s.length-1].slice(0,-1),r.type=t(s),r}}var kr=e=>e.trim();function jr(e){return e==="compact"?t=>t.map(kr).join(""):e==="preserve"?t=>t.join(`
`):e}var Ar=e=>e&&e.startsWith('"')&&e.endsWith('"');function Et(){let e=(t,{tokens:r},i)=>r.type===""?t:i;return t=>{let{tokens:r}=t.source[t.source.reduce(e,0)],i=r.description.trimLeft(),n=i.split('"');if(n.length>1&&n[0]===""&&n.length%2===1)return t.name=n[1],r.name=`"${n[1]}"`,[r.postName,r.description]=J(i.slice(r.name.length)),t;let s=0,a="",p=!1,l;for(let D of i){if(s===0&&Te(D))break;D==="["&&s++,D==="]"&&s--,a+=D}if(s!==0)return t.problems.push({code:"spec:name:unpaired-brackets",message:"unpaired brackets",line:t.source[0].number,critical:!0}),t;let T=a;if(a[0]==="["&&a[a.length-1]==="]"){p=!0,a=a.slice(1,-1);let D=a.split("=");if(a=D[0].trim(),D[1]!==void 0&&(l=D.slice(1).join("=").trim()),a==="")return t.problems.push({code:"spec:name:empty-name",message:"empty name",line:t.source[0].number,critical:!0}),t;if(l==="")return t.problems.push({code:"spec:name:empty-default",message:"empty default value",line:t.source[0].number,critical:!0}),t;if(!Ar(l)&&/=(?!>)/.test(l))return t.problems.push({code:"spec:name:invalid-default",message:"invalid default value syntax",line:t.source[0].number,critical:!0}),t}return t.optional=p,t.name=a,r.name=T,l!==void 0&&(t.default=l),[r.postName,r.description]=J(i.slice(r.name.length)),t}}function Ft(e="compact",t=k){let r=Pe(e);return i=>(i.description=r(i.source,t),i)}function Pe(e){return e==="compact"?Er:e==="preserve"?Lr:e}function Er(e,t=k){return e.map(({tokens:{description:r}})=>r.trim()).filter(r=>r!=="").join(" ")}var Fr=(e,{tokens:t},r)=>t.type===""?e:r,Ir=({tokens:e})=>(e.delimiter===""?e.start:e.postDelimiter.slice(1))+e.description;function Lr(e,t=k){if(e.length===0)return"";e[0].tokens.description===""&&e[0].tokens.delimiter===t.start&&(e=e.slice(1));let r=e[e.length-1];return r!==void 0&&r.tokens.description===""&&r.tokens.end.endsWith(t.end)&&(e=e.slice(0,-1)),e=e.slice(e.reduce(Fr,0)),e.map(Ir).join(`
`)}function Ke({startLine:e=0,fence:t="```",spacing:r="compact",markers:i=k,tokenizers:n=[jt(),At(r),Et(),Ft(r)]}={}){if(e<0||e%1>0)throw new Error("Invalid startLine");let s=be({startLine:e,markers:i}),a=Se({fence:t}),p=De({tokenizers:n}),l=Pe(r);return function(T){let D=[];for(let gt of Ge(T)){let q=s(gt);if(q===null)continue;let Ae=a(q),Ee=Ae.slice(1).map(p);D.push({description:l(Ae[0],i),tags:Ee,source:q,problems:Ee.reduce((br,Dr)=>br.concat(Dr.problems),[])})}return D}}function vr(e){return e.start+e.delimiter+e.postDelimiter+e.tag+e.postTag+e.type+e.postType+e.name+e.postName+e.description+e.end+e.lineEnd}function we(){return e=>e.source.map(({tokens:t})=>vr(t)).join(`
`)}var Rr={line:0,start:0,delimiter:0,postDelimiter:0,tag:0,postTag:0,name:0,postName:0,type:0,postType:0,description:0,end:0,lineEnd:0};var to=Object.keys(Rr);function Xe(e,t={}){return Ke(t)(e)}var No=we();var Ye=u(d(),1),y=class{constructor(t){this._jsDoc={};let r=this._getComment(t),i=this._collect(r);for(let n of i)this._jsDoc[n.kind]===void 0&&(this._jsDoc[n.kind]=[]),this._jsDoc[n.kind]?.push(new kt(n.kind,n.value))}hasTag(t){return this._jsDoc[t]!==void 0}getTag(t){return this._jsDoc[t]?.[0]}getAllTags(t){return this._jsDoc[t]??[]}isIgnored(){return this.hasTag(w.ignore)||this.hasTag(w.internal)||this.hasTag(w.private)}serialize(){return Object.entries(this._jsDoc).flatMap(([t,r])=>r.map(i=>({kind:t,value:i.serialize()})))}_getComment(t){let r=t.getSourceFile()?.text;return r?(Ye.default.getLeadingCommentRanges(r,t.pos)??[]).map(n=>r.substring(n.pos,n.end)).join(`
`):""}_collect(t){let r=[],i=Xe(t,{spacing:"preserve"});for(let n of i){if(n.problems.length)continue;let s=this._trimNewLines(n.description??"");s!==""&&r.push({kind:w.description,value:s});for(let a of n.tags){let p=a.tag??"";r.push({kind:p,value:this._getTagValue(p,a)})}}return r}_getTagValue(t,r){let i={},n=r.type??"",s=r.default??"",a=this._trimNewLines(this._normalizeDescription(r.description??"")),p=r.name??"";s!==""&&(i.default=s),r.optional&&(i.optional=!0),n!==""&&(i.type=n),p!==""&&(i.name=p),a!==""&&(i.description=a);let l=Object.keys(i).length;if(l===1&&(i.description??i.name))return p||a;if(l===2&&i.description&&i.name){let T=r.source.find(gt=>gt.source.includes(t));if(!((T?.tokens.name??"")+(T?.tokens.description??"")).includes("-"))return[p,a].join(" ")}return i}_trimNewLines(t=""){return t.replace(/^\s+|\s+$/g,"")}_normalizeDescription(t=""){return t.startsWith("- ")?t.slice(2):t}};var dt=u(d(),1),C=class{constructor(t,r){this._decorator=t,this._context=r,this._jsDoc=new y(t)}getName(){let t=this._decorator.expression;return dt.default.isCallExpression(t)&&(t=t.expression),t.getText()}getTSNode(){return this._decorator}getContext(){return this._context}getJSDoc(){return this._jsDoc}hasArguments(){return!!this.getArguments().length}getArguments(){let t=this._decorator.expression;return dt.default.isCallExpression(t)?t.arguments.map(r=>z(r,this._context)):[]}getLine(){let t=this._decorator.expression;return dt.default.isCallExpression(t)?this._context.getLocation(t.expression).line:this._context.getLocation(t).line}getPath(){let t=this._decorator.expression;return dt.default.isCallExpression(t)?this._context.getLocation(t.expression).path:this._context.getLocation(t).path}serialize(){let t=this.getPath(),r=this.getLine(),i={name:this.getName()};return r!=null&&(i.source={path:t,line:r}),o(i,"jsDoc",this.getJSDoc().serialize()),o(i,"arguments",this.getArguments()),i}};var Oe=u(d(),1),$=class{constructor(t,r,i){this._node=t,this._symbol=r,this._context=i,this._jsDoc=new y(this._node)}getName(){return this.isNamed()?"__namedParameter":this._symbol?this._symbol.getName()??"":this._node.name.getText()??""}getTSNode(){return this._node}getContext(){return this._context}getLine(){return this._context.getLinePosition(this._node)}getType(){let t=this._context.getTypeChecker(),r=this._symbol?t.getTypeOfSymbolAtLocation(this._symbol,this._node):null;return r?m(r,this._context):et(this._node,this._context)}getDefault(){return z(this._node.initializer,this._context)}getDecorators(){return M(this._node).map(t=>new C(t,this._context))}getNamedElements(){if(!this.isNamed())return[];let t=this._node.name.elements??[],r=[];for(let i of t)r.push(new Mt(i,this._context));return r}getJSDoc(){return this._jsDoc}isNamed(){return Oe.default.isObjectBindingPattern(this._node.name)}isRest(){return!!(this._node.dotDotDotToken&&this._node.type?.kind===Oe.default.SyntaxKind.ArrayType)}isOptional(){return!!this._context.getTypeChecker().isOptionalParameter(this._node)}serialize(){let t={name:this.getName(),type:this.getType().serialize(),line:this.getLine()};return o(t,"decorators",this.getDecorators().map(r=>r.serialize())),o(t,"jsDoc",this.getJSDoc().serialize()),o(t,"optional",this.isOptional()),o(t,"rest",this.isRest()),o(t,"named",this.isNamed()),o(t,"default",this.getDefault()),o(t,"elements",this.getNamedElements().map(r=>r.serialize())),t}};var tr=u(d(),1),It=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Function}getText(){return this._context.getTypeChecker().typeToString(this._type)}getTypeParameters(){return this._node.typeParameters?.map(t=>new j(t,this._context))??[]}getParameters(){return(this._node.parameters??[]).map(t=>{let r=this._context.getSymbol(t),i=r?.getDeclarations()?.find(n=>tr.default.isParameter(n));return new $(i??t,r,this._context)})}getReturnType(){return m(this._node.type,this._context)}serialize(){let t={text:this.getText(),kind:this.getKind(),return:this.getReturnType().serialize()};return o(t,"typeParameters",this.getTypeParameters().map(r=>r.serialize())),o(t,"parameters",this.getParameters().map(r=>r.serialize())),t}};var Lt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Optional}getText(){return`${this.getElementType().getText()}?`}getElementType(){return m(this._node.type,this._context)}serialize(){return{text:this.getText(),kind:this.getKind(),elementType:this.getElementType().serialize()}}};var B;(function(e){e.public="public",e.private="private",e.protected="protected"})(B||(B={}));var f=u(d(),1);function vt(e){let t=f.default.getCombinedModifierFlags(e);return F(t,f.default.ModifierFlags.Private)||e.name&&f.default.isPrivateIdentifier(e.name)?B.private:F(t,f.default.ModifierFlags.Protected)?B.protected:B.public}function Rt(e,t){let r=t.getTypeChecker(),i=r.getTypeAtLocation(e).getSymbol(),s=(i&&r.getDeclaredTypeOfSymbol(i))?.getProperties()??[];return rr(e,s,r)}function er(e,t){let r=t.getTypeChecker(),i=r.getTypeAtLocation(e).getSymbol(),n=i&&r.getTypeOfSymbolAtLocation(i,e),s=(n&&r.getPropertiesOfType(n))??[];return rr(e,s,r)}function rr(e,t,r){let i=[];for(let n of t){let s=n.getDeclarations()?.[0],a=s?.getSourceFile()?.fileName??"",p=r.getTypeOfSymbolAtLocation(n,e);if(F(n.flags,f.default.SymbolFlags.ModuleMember)||F(n.flags,f.default.SymbolFlags.Prototype)||K(a))continue;let l=Vr(e,n,r);i.push({inherited:l,symbol:n,type:p,overrides:Jr(s)})}return i}function Vr(e,t,r){let n=r.getTypeAtLocation(e).getBaseTypes()?.[0];if(!n)return!1;let s=n.getSymbol()?.getDeclarations()?.slice()??[],a=s.flatMap(p=>f.default.isClassDeclaration(p)?p.members.filter(f.default.isConstructorDeclaration):[]);return s.push(...a),s.some(p=>t.getDeclarations()?.some(l=>l.parent===p))}function ir(e){return e?f.default.isMethodSignature(e)||f.default.isPropertySignature(e)||f.default.isPropertyDeclaration(e)||f.default.isMethodDeclaration(e):!1}function Vt(e){return!e||!f.default.canHaveModifiers(e)||f.default.isVariableStatement(e)||f.default.isImportDeclaration(e)?!1:F(f.default.getCombinedModifierFlags(e),f.default.ModifierFlags.Readonly)}function Jr(e){return!e||!f.default.canHaveModifiers(e)||f.default.isVariableStatement(e)||f.default.isImportDeclaration(e)?!1:F(f.default.getCombinedModifierFlags(e),f.default.ModifierFlags.Override)}function ht(e){return!!e&&F(e.flags,f.default.SymbolFlags.Optional)}function rt(e){return!e||!f.default.canHaveModifiers(e)||f.default.isVariableStatement(e)||f.default.isImportDeclaration(e)?!1:F(f.default.getCombinedModifierFlags(e),f.default.ModifierFlags.Static)}function it(e){return!e||!f.default.canHaveModifiers(e)||f.default.isVariableStatement(e)||f.default.isImportDeclaration(e)?!1:F(f.default.getCombinedModifierFlags(e),f.default.ModifierFlags.Abstract)}function F(e,t){return(e&t)===t}var H=u(d(),1);function nr(e){return e?.statements.find(H.default.isReturnStatement)}function G(e){return e!=null&&H.default.isArrowFunction(e)}function Z(e){return e!=null&&H.default.isFunctionExpression(e)}function Jt(e){if(e==null)return!1;if(H.default.isFunctionDeclaration(e))return!0;if(!H.default.isVariableStatement(e))return!1;let t=e.declarationList.declarations[0];if(!t)return!1;let r=t.initializer;return!!r&&(H.default.isArrowFunction(r)||H.default.isFunctionExpression(r))}var W;(function(e){e.Property="Property",e.Method="Method",e.IndexSignature="IndexSignature"})(W||(W={}));var nt=u(d(),1),Q=class{constructor(t,r,i){this._node=t,this._nodeContext=r,this._context=i;let[n,s]=this._getAccessors();n?this._jsDoc=new y(n):s?this._jsDoc=new y(s):this._jsDoc=new y(this._node)}getName(){let[t,r]=this._getAccessors();return t?t.name.getText()??"":r?r.name.getText()??"":nt.default.isIdentifier(this._node.name)?this._node.name.escapedText??"":this._node.name.getText()??""}getKind(){return W.Property}getTSNode(){return this._node}getContext(){return this._context}getLine(){let[t,r]=this._getAccessors();return t?this._context.getLinePosition(t):r?this._context.getLinePosition(r):this._context.getLocation(this._node).line}getType(){let t=nt.default.getJSDocType(this._node);return t?m(t,this._context):this._nodeContext?.type?m(this._nodeContext.type,this._context):this._node.type?m(this._node.type,this._context):et(this._node,this._context)}getDefault(){let t=this.getJSDoc().getTag(w.default)?.serialize()??"",[r,i]=this._getAccessors();if(t)return t;if(r)return z(nr(r.body)?.expression,this._context);if(!i)return z(this._node.initializer,this._context)}getModifier(){return nt.default.isClassElement(this._node)?vt(this._node):null}getJSDoc(){return this._jsDoc}getDecorators(){let[t,r]=this._getAccessors();return t?M(t).map(i=>new C(i,this._context)):r?M(r).map(i=>new C(i,this._context)):M(this._node).map(i=>new C(i,this._context))}isOptional(){if(this._nodeContext)return ht(this._nodeContext.symbol);let t=this._context.getSymbol(this._node);return ht(t)}isStatic(){let[t,r]=this._getAccessors();return t?rt(t):r?rt(r):rt(this._node)}isReadOnly(){let t=!!this.getJSDoc().getTag(w.readonly)?.serialize(),[r,i]=this._getAccessors();return t||!!r&&!i||Vt(this._node)}isWriteOnly(){let[t,r]=this._getAccessors();return!t&&!!r}isAbstract(){return it(this._node)}isInherited(){return!this._nodeContext?.overrides&&!!this._nodeContext?.inherited}overrides(){return!!this._nodeContext?.overrides}serialize(){let t={name:this.getName(),kind:this.getKind(),type:this.getType().serialize()};return o(t,"line",this.getLine()),o(t,"optional",this.isOptional()),o(t,"jsDoc",this.getJSDoc().serialize()),o(t,"decorators",this.getDecorators().map(r=>r.serialize())),o(t,"default",this.getDefault()),o(t,"static",this.isStatic()),o(t,"readOnly",this.isReadOnly()),o(t,"abstract",this.isAbstract()),o(t,"override",this.overrides()),o(t,"inherited",this.isInherited()),o(t,"writeOnly",this.isWriteOnly()),t}_getAccessors(){let t=this._nodeContext?.symbol?.getDeclarations()??[],r=t.find(nt.default.isGetAccessor),i=t.find(nt.default.isSetAccessor);return[r,i]}};var ze=u(d(),1);function or(e){return!!(e&&ze.default.isModuleDeclaration(e)&&e.body&&ze.default.isModuleBlock(e.body))}function Br(e){let t=[e.name.getText()??""],r=e;for(;or(r.parent?.parent);)t.push(r.parent?.parent?.name.getText()??""),r=r.parent?.parent;return t.reverse().join(".")}function A(e){let t=e.parent?.parent;for(;t&&!or(t);)t=t.parent;return t?Br(t):""}var sr=u(d(),1),X=class{constructor(t,r){this._node=t,this._context=r,this._jsDoc=new y(this._node.getDeclaration())}getContext(){return this._context}getTSNode(){return this._node}getLine(){return this._context.getLinePosition(this._node.getDeclaration())}getPath(){return this._node.getDeclaration().getSourceFile().fileName??""}getJSDoc(){return this._jsDoc}getReturnType(){let t=sr.default.getJSDocReturnType(this._node.getDeclaration());if(t)return m(t,this._context);let r=this._context.getTypeChecker().getReturnTypeOfSignature(this._node);return m(r,this._context)}getTypeParameters(){return this._node.getDeclaration().typeParameters?.map(t=>new j(t,this._context))??[]}getParameters(){let t=this._node.parameters??[],r=this._node.getDeclaration().parameters??[],i=[];for(let n=0;n<r.length;n++){let s=r[n],a=new $(s,t[n]??null,this._context);a.getJSDoc().isIgnored()||i.push(a)}return i}getParameterByName(t){return this.getParameters().find(r=>r.getName()===t)??null}serialize(){let t={return:{type:this.getReturnType().serialize()}};return o(t,"line",this.getLine()),o(t,"jsDoc",this.getJSDoc().serialize()),o(t,"typeParameters",this.getTypeParameters().map(r=>r.serialize())),o(t,"parameters",this.getParameters().map(r=>r.serialize())),t}};var _=u(d(),1),R=class{constructor(t,r,i){this._jsDoc=null,this._node=t,this._member=r,this._context=i,(_.default.isVariableStatement(t)||_.default.isPropertyDeclaration(t)||_.default.isPropertySignature(t))&&(this._jsDoc=new y(t))}getName(){return _.default.isFunctionDeclaration(this._node)||_.default.isMethodDeclaration(this._node)||_.default.isMethodSignature(this._node)||_.default.isPropertyDeclaration(this._node)||_.default.isPropertySignature(this._node)?this._node.name?.getText()??"":_.default.isVariableStatement(this._node)?this._node.declarationList.declarations.find(r=>G(r.initializer)||Z(r.initializer))?.name.getText()??"":""}getNodeType(){return g.Declaration}getContext(){return this._context}getKind(){return ir(this._node)?W.Method:x.Function}getTSNode(){return this._node}getLine(){return this._context.getLocation(this._node).line}getNamespace(){return A(this._node)}getJSDoc(){return this._jsDoc}getDecorators(){return M(this._node).map(t=>new C(t,this._context))}getDecoratorWithName(t){return this.getDecorators().find(r=>r.getName()===t)??null}getSignatures(){let t=this._getFunctionNode(),r=this._context.getTypeChecker(),i=this._member?.type;if(!i){let n=t&&this._context.getSymbol(t);i=t&&n&&r.getTypeOfSymbolAtLocation(n,t.getSourceFile())}if(!i){let n=t&&r.getSignatureFromDeclaration(t);return n?[new X(n,this._context)]:[]}return i.getNonNullableType().getCallSignatures().map(n=>new X(n,this._context))}getModifier(){return _.default.isClassElement(this._node)?vt(this._node):null}isGenerator(){let t=this._getFunctionNode();return!!t&&!_.default.isMethodSignature(t)&&!_.default.isFunctionTypeNode(t)&&!!t.asteriskToken}isAsync(){let t=this._getFunctionNode();return t?lt(t).some(r=>r.kind===_.default.SyntaxKind.AsyncKeyword):!1}isOptional(){return ht(this._member?.symbol)}isStatic(){return rt(this._node)}isReadOnly(){return Vt(this._node)}isAbstract(){return it(this._node)}isInherited(){return!this._member?.overrides&&!!this._member?.inherited}isArrowFunctionOrFunctionExpression(){return _.default.isVariableStatement(this._node)?this._node.declarationList.declarations.some(t=>G(t.initializer)||Z(t.initializer)):!1}overrides(){return!!this._member?.overrides}serialize(){let t={name:this.getName(),kind:this.getKind(),signatures:this.getSignatures().map(r=>r.serialize())};return o(t,"namespace",this.getNamespace()),o(t,"jsDoc",this.getJSDoc()?.serialize()),o(t,"decorators",this.getDecorators().map(r=>r.serialize())),o(t,"async",this.isAsync()),o(t,"generator",this.isGenerator()),o(t,"static",this.isStatic()),o(t,"readOnly",this.isReadOnly()),o(t,"abstract",this.isAbstract()),o(t,"override",this.overrides()),o(t,"inherited",this.isInherited()),o(t,"optional",this.isOptional()),t}_getFunctionNode(){let t=this._node;return _.default.isVariableStatement(this._node)&&(t=this._node.declarationList.declarations.find(i=>G(i.initializer)||Z(i.initializer))?.initializer),_.default.isPropertySignature(this._node)&&(t=this._node.type&&_.default.isFunctionTypeNode(this._node.type)?this._node.type:null),_.default.isPropertyDeclaration(this._node)&&(t=this._node.initializer),t==null||!_.default.isFunctionDeclaration(t)&&!_.default.isArrowFunction(t)&&!_.default.isFunctionExpression(t)&&!_.default.isMethodSignature(t)&&!_.default.isMethodDeclaration(t)&&!_.default.isFunctionTypeNode(t)?null:t}};var Me=u(d(),1),Bt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getKind(){return c.ObjectLiteral}getProperties(){let t=this._context.getTypeChecker(),r=this._node.members??[],i=[];for(let n of r){if(!Me.default.isPropertySignature(n))continue;let s=this._context.getSymbol(n),a=s&&t.getTypeOfSymbolAtLocation(s,this._node);i.push(new Q(n,{symbol:s,type:a},this._context))}return i}getMethods(){let t=this._context.getTypeChecker(),r=this._node.members??[],i=[];for(let n of r){if(!Me.default.isMethodSignature(n))continue;let s=this._context.getSymbol(n),a=s&&t.getTypeOfSymbolAtLocation(s,this._node);i.push(new R(n,{symbol:s,type:a},this._context))}return i}serialize(){let t={text:this.getText(),kind:this.getKind()};return o(t,"properties",this.getProperties().map(r=>r.serialize())),o(t,"methods",this.getMethods().map(r=>r.serialize())),t}};var ot=u(d(),1),st=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Unknown}getText(){let t={[ot.default.SyntaxKind.AnyKeyword]:"any",[ot.default.SyntaxKind.NeverKeyword]:"never",[ot.default.SyntaxKind.ObjectKeyword]:"object",[ot.default.SyntaxKind.UnknownKeyword]:"unknown",[ot.default.SyntaxKind.IntrinsicKeyword]:"intrinsic"},r=this._node&&t[this._node.kind];return r||this._context.getTypeChecker().typeToString(this._type)}serialize(){return{text:this.getText(),kind:this.getKind()}}};var I=u(d(),1),Wt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Literal}getText(){switch(this._node.literal.kind){case I.default.SyntaxKind.TrueKeyword:return"true";case I.default.SyntaxKind.FalseKeyword:return"false";case I.default.SyntaxKind.NullKeyword:return"null";case I.default.SyntaxKind.PrefixUnaryExpression:{let r=this._node.literal.operand;return this._getUnaryExpressionText(r)}case I.default.SyntaxKind.NumericLiteral:return this._node.literal.text;case I.default.SyntaxKind.StringLiteral:return`"${this._node.literal.text}"`;case I.default.SyntaxKind.BigIntLiteral:return this._node.literal.text;case I.default.SyntaxKind.NoSubstitutionTemplateLiteral:return this._node.literal.text;default:return""}}serialize(){return{text:this.getText(),kind:this.getKind()}}_getUnaryExpressionText(t){switch(t.kind){case I.default.SyntaxKind.NumericLiteral:return this._node.literal.getText();case I.default.SyntaxKind.BigIntLiteral:return this._node.literal.getText().replace("n","");default:return""}}};var Ut=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Mapped}getText(){return this._context.getTypeChecker().typeToString(this._type)}serialize(){return{text:this.getText(),kind:this.getKind()}}};var $t=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i,this._loc=i.getLocation(t.exprName)}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Query}getPath(){return this._loc.path}getLine(){return this._loc.line}getText(){return this._context.getTypeChecker().typeToString(this._type)}getTypeArguments(){return(this._node.typeArguments??[]).map(t=>m(t,this._context))}serialize(){let t={text:this.getText(),kind:this.getKind()},r={},i=this.getPath(),n=this.getLine();return!K(i)&&n!=null&&(r.line=n,r.path=i),o(t,"source",r),o(t,"typeArguments",this.getTypeArguments().map(s=>s.serialize())),t}};var Ht=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Infer}getText(){let t=this.getConstraint(),r=this._node.typeParameter.name.text;return t?`infer ${r} extends ${t.getText()}`:`infer ${r}`}getConstraint(){let t=this._node.typeParameter.constraint;return t?m(t,this._context):null}serialize(){let t={text:this.getText(),kind:this.getKind()};return o(t,"constraint",this.getConstraint()?.serialize()),t}};var Qt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Union}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getElements(){return this._node.types.map(t=>m(t,this._context))}serialize(){return{text:this.getText(),kind:this.getKind(),elements:this.getElements().map(t=>t.serialize())}}};var qt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Array}getText(){return`${this.getElementType().getText()}[]`}getElementType(){return m(this._node.elementType,this._context)}serialize(){return{text:this.getText(),kind:this.getKind(),elementType:this.getElementType().serialize()}}};var Gt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Tuple}getText(){return`[${this.getElements().map(t=>t.getText()).join(", ")}]`}getElements(){return this._node.elements.map(t=>m(t,this._context))}serialize(){return{text:this.getText(),kind:this.getKind(),elements:this.getElements().map(t=>t.serialize())}}};var Zt=class{constructor(t,r,i){this._node=t,this._type=r,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return c.Rest}getText(){return`...${this.getElementType().getText()}`}getElementType(){return m(this._node.type,this._context)}serialize(){return{text:this.getText(),kind:this.getKind(),elementType:this.getElementType().serialize()}}};var h=u(d(),1),Wr={[h.default.SyntaxKind.TypeLiteral]:(e,t,r)=>new Bt(e,t,r),[h.default.SyntaxKind.ConditionalType]:(e,t,r)=>new wt(e,t,r),[h.default.SyntaxKind.UnionType]:(e,t,r)=>new Qt(e,t,r),[h.default.SyntaxKind.IntersectionType]:(e,t,r)=>new Kt(e,t,r),[h.default.SyntaxKind.ArrayType]:(e,t,r)=>new qt(e,t,r),[h.default.SyntaxKind.TypeReference]:(e,t,r)=>new Ct(e,t,r),[h.default.SyntaxKind.TupleType]:(e,t,r)=>new Gt(e,t,r),[h.default.SyntaxKind.NamedTupleMember]:(e,t,r)=>new Pt(e,t,r),[h.default.SyntaxKind.TypeOperator]:(e,t,r)=>new zt(e,t,r),[h.default.SyntaxKind.LiteralType]:(e,t,r)=>new Wt(e,t,r),[h.default.SyntaxKind.IndexedAccessType]:(e,t,r)=>new Dt(e,t,r),[h.default.SyntaxKind.FunctionType]:(e,t,r)=>new It(e,t,r),[h.default.SyntaxKind.TypeQuery]:(e,t,r)=>new $t(e,t,r),[h.default.SyntaxKind.InferType]:(e,t,r)=>new Ht(e,t,r),[h.default.SyntaxKind.MappedType]:(e,t,r)=>new Ut(e,t,r),[h.default.SyntaxKind.OptionalType]:(e,t,r)=>new Lt(e,t,r),[h.default.SyntaxKind.TypePredicate]:(e,t,r)=>new Ot(e,t,r),[h.default.SyntaxKind.RestType]:(e,t,r)=>new Zt(e,t,r),[h.default.SyntaxKind.TemplateLiteralType]:(e,t,r)=>new bt(e,t,r),[h.default.SyntaxKind.AnyKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.BigIntKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.BooleanKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.NeverKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.NumberKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.ObjectKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.StringKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.SymbolKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.UndefinedKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.VoidKeyword]:(e,t,r)=>new O(e,t,r),[h.default.SyntaxKind.UnknownKeyword]:(e,t,r)=>new st(e,t,r)};function m(e,t){let r=t.getTypeChecker(),i,n;if("kind"in e)i=e,n=r.getTypeFromTypeNode(e);else if(i=r.typeToTypeNode(e,void 0,h.default.NodeBuilderFlags.IgnoreErrors)??null,n=e,!i)return new st(null,e,t);h.default.isParenthesizedTypeNode(i)&&(i=i.type,n=r.getTypeFromTypeNode(i));let s=Wr[i.kind];return s?s(i,n,t):new st(i,n,t)}function et(e,t){let r=t.getTypeChecker(),i=h.default.getJSDocType(e);if(i)return m(i,t);let n=r.getTypeAtLocation(e);return Ur(e)||(n=r.getBaseTypeOfLiteralType(n)),m(n,t)}function Ur(e){return h.default.hasOnlyExpressionInitializer(e)&&!!e.initializer&&(h.default.isAsExpression(e.initializer)||h.default.isTypeAssertionExpression(e))}var j=class{constructor(t,r){this._node=t,this._context=r}getContext(){return this._context}getName(){return this._node.name.getText()??""}getTSNode(){return this._node}getLine(){return this._context.getLinePosition(this._node)}getDefault(){return this._node.default?m(this._node.default,this._context):null}getConstraint(){return this._node.constraint?m(this._node.constraint,this._context):null}hasDefault(){return!!this._node.default}serialize(){let t={name:this.getName()};return o(t,"default",this.getDefault()?.serialize()),o(t,"constraint",this.getConstraint()?.serialize()),t}};var Xt=class{constructor(t,r){this._node=t,this._context=r,this._jsDoc=new y(this._node)}getContext(){return this._context}getTSNode(){return this._node}getNodeType(){return g.Declaration}getKind(){return x.TypeAlias}getName(){return this._node.name.getText()??""}getLine(){return this._context.getLinePosition(this._node)}getNamespace(){return A(this._node)}getJSDoc(){return this._jsDoc}getValue(){return m(this._node.type,this._context)}getTypeParameters(){return this._node.typeParameters?.map(t=>new j(t,this._context))??[]}serialize(){let t={name:this.getName(),kind:this.getKind(),line:this.getLine(),value:this.getValue().serialize()};return o(t,"namespace",this.getNamespace()),o(t,"jsDoc",this.getJSDoc().serialize()),o(t,"typeParameters",this.getTypeParameters().map(r=>r.serialize())),t}};var ar=u(d(),1),cr={isNode:e=>ar.default.isTypeAliasDeclaration(e),create:(e,t)=>[t.registerReflectedNode(e,()=>new Xt(e,t))]};var pr=u(d(),1),at=class{constructor(t,r){this._node=t,this._context=r,this._loc=r.getLocation(t.expression)}getContext(){return this._context}getTSNode(){return this._node}getName(){return this._node.expression.getText()}getTypeArguments(){return(this._node.typeArguments??[]).map(t=>m(t,this._context))}getPath(){return this._loc.path}getLine(){return this._loc.line}serialize(){let t={name:this.getName(),kind:this._loc.symbol&&F(this._loc.symbol.flags,pr.default.SymbolFlags.Class)?x.Class:x.Interface},r={},i=this.getPath(),n=this.getLine();return!K(i)&&n!=null&&(r.line=n,r.path=i),o(t,"source",r),o(t,"typeArguments",this.getTypeArguments().map(s=>s.serialize())),t}};var Yt=class{constructor(t,r,i){this._node=t,this._member=r,this._context=i,this._parameter=this._getParameter(),this._jsDoc=new y(this._node)}getName(){return this._parameter?.getName()??""}getContext(){return this._context}getKind(){return W.IndexSignature}getTSNode(){return this._node}getJSDoc(){return this._jsDoc}getLine(){return this._context.getLinePosition(this._node)}getType(){return m(this._node.type,this._context)}getIndexType(){return this._parameter?.getType()??null}isOptional(){return!!this._parameter?.isOptional()}serialize(){let t={name:this.getName(),line:this.getLine(),kind:W.IndexSignature,type:this.getType().serialize()};return o(t,"indexType",this.getIndexType()?.serialize()),o(t,"optional",this.isOptional()),o(t,"jsDoc",this.getJSDoc().serialize()),t}_getParameter(){let t=this._member.type?.getCallSignatures()?.[0],r=this._node.parameters??[],i=t?.parameters??[],n=r[0],s=i[0]??null;return n?new $(n,s,this._context):null}};var V=u(d(),1),te=class{constructor(t,r){this._members=[],this._heritage=[],this._node=t,this._context=r,this._members=Rt(this._node,this._context),this._jsDoc=new y(this._node),this._heritage=(this._node.heritageClauses??[]).flatMap(i=>i.types.map(n=>new at(n,this._context)))}getName(){return this._node.name.getText()??""}getNodeType(){return g.Declaration}getKind(){return x.Interface}getContext(){return this._context}getTSNode(){return this._node}getLine(){return this._context.getLinePosition(this._node)}getIndexSignature(){let t=this._context.getTypeChecker(),r=this._context.getSymbol(this._node)?.members?.get("__index"),i=r?.getDeclarations()?.[0];if(!i||!V.default.isIndexSignatureDeclaration(i))return null;let n={symbol:r,type:t.getTypeOfSymbolAtLocation(r,this._node)},s=()=>new Yt(i,n,this._context);return this._context.registerReflectedNode(i,s)}getProperties(){let t=[];for(let r of this._members){let{symbol:i}=r,n=i?.getDeclarations()?.[0];if(!n)continue;let s=V.default.isPropertySignature(n)&&n.type&&V.default.isFunctionTypeNode(n.type);if((V.default.isPropertySignature(n)||V.default.isGetAccessor(n)||V.default.isSetAccessor(n))&&!s){let a=new Q(n,r,this._context);t.push(a)}}return t}getPropertyWithName(t){return this.getProperties().find(r=>r.getName()===t)??null}getMethods(){let t=[];for(let r of this._members){let{symbol:i}=r,n=i?.getDeclarations()?.[0];if(!n)continue;let s=V.default.isPropertySignature(n)&&n.type&&V.default.isFunctionTypeNode(n.type);if(V.default.isMethodSignature(n)||s){let a=new R(n,r,this._context);t.push(a)}}return t}getMethodWithName(t){return this.getMethods().find(r=>r.getName()===t)??null}getTypeParameters(){return(this._node.typeParameters??[]).map(t=>new j(t,this._context))}getNamespace(){return A(this._node)}getJSDoc(){return this._jsDoc}getHeritage(){return this._heritage}serialize(){let t={name:this.getName(),kind:this.getKind(),line:this.getLine()};return o(t,"heritage",this.getHeritage().map(r=>r.serialize())),o(t,"typeParameters",this.getTypeParameters().map(r=>r.serialize())),o(t,"jsDoc",this.getJSDoc().serialize()),o(t,"namespace",this.getNamespace()),o(t,"indexSignature",this.getIndexSignature()?.serialize()),o(t,"properties",this.getProperties().map(r=>r.serialize())),o(t,"methods",this.getMethods().map(r=>r.serialize())),t}};var mr=u(d(),1),lr={isNode:e=>mr.default.isInterfaceDeclaration(e),create:(e,t)=>[t.registerReflectedNode(e,()=>new te(e,t))]};var ur={isNode:Jt,create:(e,t)=>[t.registerReflectedNode(e,()=>new R(e,null,t))]};var ee=class{constructor(t,r,i){this._node=t,this._declaration=r,this._context=i,this._jsDoc=new y(this._node)}getContext(){return this._context}getName(){return this._declaration.name.getText()??""}getTSNode(){return this._declaration}getNodeType(){return g.Declaration}getKind(){return x.Variable}getDecorators(){return M(this._node).map(t=>new C(t,this._context))}getLine(){return this._context.getLinePosition(this._node)}getType(){return et(this._declaration,this._context)}getValue(){return this.getJSDoc().getTag(w.default)?.serialize()??z(this._declaration.initializer,this._context)}getNamespace(){return A(this._node)}getJSDoc(){return this._jsDoc}serialize(){let t=this.getValue(),r={name:this.getName(),kind:this.getKind(),line:this.getLine(),type:this.getType().serialize()};return t!==""&&(r.default=t),o(r,"jsDoc",this.getJSDoc().serialize()),o(r,"decorators",this.getDecorators().map(i=>i.serialize())),o(r,"namespace",this.getNamespace()),r}};var re=u(d(),1);function ie(e){if(re.default.isClassDeclaration(e))return!0;if(!re.default.isVariableStatement(e))return!1;let t=e.declarationList.declarations[0];if(!t)return!1;let r=t.initializer;return!!r&&re.default.isClassExpression(r)}var dr=u(d(),1),hr={isNode:e=>dr.default.isVariableStatement(e)&&!Jt(e)&&!ie(e),create:(e,t)=>{let r=[];for(let i of e.declarationList.declarations){let n=()=>new ee(e,i,t),s=t.registerReflectedNode(i,n);r.push(s)}return r}};var P;(function(e){e.Default="Default",e.Named="Named",e.Namespace="Namespace",e.SideEffect="SideEffect",e.Dynamic="Dynamic"})(P||(P={}));var ne=class{constructor(t,r){this._node=t,this._context=r}getTSNode(){return this._node}getNodeType(){return g.Import}getKind(){return P.SideEffect}getContext(){return this._context}getImportPath(){return this._node.moduleSpecifier.text??""}isBareModuleSpecifier(){return U(this.getImportPath())}serialize(){let t={kind:P.SideEffect,importPath:this.getImportPath()};return o(t,"bareModuleSpecifier",this.isBareModuleSpecifier()),t}};var oe=class{constructor(t,r){this._node=t,this._context=r}getTSNode(){return this._node}getContext(){return this._context}getName(){return(this._node.importClause?.namedBindings).name.escapedText??""}getNodeType(){return g.Import}getKind(){return P.Namespace}getImportPath(){return this._node.moduleSpecifier.text??""}getOriginalPath(){let t=(this._node.importClause?.namedBindings).name,r=this.getImportPath(),i=this._context.getSystem().getCommandLine().options;return tt(r,i)?Y(t,this._context):r}isTypeOnly(){return!!this._node.importClause?.isTypeOnly}isBareModuleSpecifier(){return U(this.getImportPath())}serialize(){let t=this.getOriginalPath(),r={name:this.getName(),kind:this.getKind(),importPath:this.getImportPath()};return t!==r.importPath&&(r.originalPath=t),o(r,"typeOnly",this.isTypeOnly()),o(r,"bareModuleSpecifier",this.isBareModuleSpecifier()),r}};var se=class{constructor(t,r){this._node=t,this._context=r}getName(){return this._node.importClause?.name?.escapedText??""}getTSNode(){return this._node}getContext(){return this._context}getNodeType(){return g.Import}getKind(){return P.Default}getReferenceName(){return this.getName()}getImportPath(){return this._node.moduleSpecifier.text??""}getOriginalPath(){let t=this._node.importClause?.name,r=this.getImportPath(),i=this._context.getSystem().getCommandLine().options;return tt(r,i)?Y(t,this._context):r}isTypeOnly(){return!!this._node.importClause?.isTypeOnly}isBareModuleSpecifier(){return U(this.getImportPath())}serialize(){let t=this.getOriginalPath(),r={name:this.getName(),kind:this.getKind(),importPath:this.getImportPath()};return t!==r.importPath&&(r.originalPath=t),o(r,"typeOnly",this.isTypeOnly()),o(r,"bareModuleSpecifier",this.isBareModuleSpecifier()),r}};var ae=class{constructor(t,r,i){this._node=t,this._element=r,this._context=i}getTSNode(){return this._node}getContext(){return this._context}getName(){return this._element.name.escapedText??""}getReferenceName(){return this._element.propertyName?.escapedText??this.getName()}getNodeType(){return g.Import}getKind(){return P.Named}getImportPath(){return this._node.moduleSpecifier.text??""}getOriginalPath(){let t=this.getImportPath(),r=this._context.getSystem().getCommandLine().options;return tt(t,r)?Y(this._element.name,this._context):t}isTypeOnly(){return!!this._node.importClause?.isTypeOnly}isBareModuleSpecifier(){return U(this.getImportPath())}serialize(){let t=this.getOriginalPath(),r=this.getReferenceName(),i={name:this.getName(),kind:this.getKind(),importPath:this.getImportPath()};return r!==i.name&&(i.referenceName=r),t!==i.importPath&&(i.originalPath=t),o(i,"typeOnly",this.isTypeOnly()),o(i,"bareModuleSpecifier",this.isBareModuleSpecifier()),i}};var gr=u(d(),1),ce={isNode:e=>gr.default.isImportDeclaration(e),create:(e,t)=>{let r=[];return We(e)&&r.push(new se(e,t)),$e(e)&&r.push(new ne(e,t)),ye(e)&&((e.importClause?.namedBindings).elements??[]).forEach(n=>r.push(new ae(e,n,t))),Ue(e)&&r.push(new oe(e,t)),r}};function fr(e,t){let r=t.getTypeChecker(),i=r.getTypeAtLocation(e),n=i.isClassOrInterface()?r.getBaseTypes(i):[];for(let s of n)if(yr(s,r))return!0;return!1}function yr(e,t){return e.getSymbol()?.getName()==="HTMLElement"?!0:e.isClassOrInterface()?t.getBaseTypes(e).some(i=>yr(i,t)):!1}var L=u(d(),1),pe=class{constructor(t,r){this._instanceMembers=[],this._staticMembers=[],this._heritage=[],this._node=t,this._context=r,this._jsDoc=new y(t);let i=this._getClassNode();i&&(this._instanceMembers=Rt(i,this._context),this._staticMembers=er(i,this._context),this._heritage=(i.heritageClauses??[]).flatMap(n=>n.types.map(s=>new at(s,this._context))))}getName(){return L.default.isVariableStatement(this._node)?this._node.declarationList.declarations[0]?.name.getText()??"":this._node.name?.getText()??""}getNodeType(){return g.Declaration}getKind(){return x.Class}getContext(){return this._context}getTSNode(){return this._node}getLine(){return this._context.getLinePosition(this._node)}getNamespace(){return A(this._node)}getJSDoc(){return this._jsDoc}getDecorators(){return M(this._node).map(t=>new C(t,this._context))}getDecoratorWithName(t){return this.getDecorators().find(r=>r.getName()===t)??null}getConstructors(){let t=this._getClassNode();if(!t)return[];let r=this._context.getTypeChecker(),i=r.getTypeAtLocation(t).getSymbol(),s=(i&&r.getTypeOfSymbolAtLocation(i,t))?.getConstructSignatures()??[],a=[];for(let p of s){if(!p.getDeclaration())continue;let l=new X(p,this._context),T=l.getPath();T&&!K(T)&&a.push(l)}return a}getProperties(){return this._getPropertyMembers(this._instanceMembers)}getStaticProperties(){return this._getPropertyMembers(this._staticMembers)}getPropertyWithName(t){return this.getProperties().find(r=>r.getName()===t)??null}getMethods(){return this._getMethodMembers(this._instanceMembers)}getStaticMethods(){return this._getMethodMembers(this._staticMembers)}getMethodWithName(t){return this.getMethods().find(r=>r.getName()===t)??null}getTypeParameters(){let t=this._getClassNode();return t?t.typeParameters?.map(r=>new j(r,this._context))??[]:[]}getHeritage(){return this._heritage}isCustomElement(){let t=this._getClassNode();return t?fr(t,this._context):!1}isAbstract(){let t=this._getClassNode();return t?it(t):!1}serialize(){let t={name:this.getName(),kind:this.getKind(),line:this.getLine()};return o(t,"constructors",this.getConstructors().map(r=>r.serialize())),o(t,"decorators",this.getDecorators().map(r=>r.serialize())),o(t,"jsDoc",this.getJSDoc().serialize()),o(t,"typeParameters",this.getTypeParameters().map(r=>r.serialize())),o(t,"heritage",this.getHeritage().map(r=>r.serialize())),o(t,"abstract",this.isAbstract()),o(t,"customElement",this.isCustomElement()),o(t,"namespace",this.getNamespace()),o(t,"properties",this.getProperties().map(r=>r.serialize())),o(t,"staticProperties",this.getStaticProperties().map(r=>r.serialize())),o(t,"methods",this.getMethods().map(r=>r.serialize())),o(t,"staticMethods",this.getStaticMethods().map(r=>r.serialize())),t}_getPropertyMembers(t){let r=[];for(let i of t){let{symbol:n}=i,s=n?.getDeclarations()?.[0];if(!s)continue;let a=L.default.isPropertyDeclaration(s);if(!(L.default.isMethodDeclaration(s)||a&&(G(s.initializer)||Z(s.initializer)))&&(a||L.default.isGetAccessor(s)||L.default.isSetAccessor(s))){let l=new Q(s,i,this._context);l.getModifier()===B.public&&r.push(l)}}return r}_getMethodMembers(t){let r=[];for(let i of t){let{symbol:n}=i,s=n?.getDeclarations()?.[0];if(!s)continue;let a=L.default.isPropertyDeclaration(s);if(L.default.isMethodDeclaration(s)||a&&(G(s.initializer)||Z(s.initializer))){let l=new R(s,i,this._context);l.getModifier()===B.public&&r.push(l)}}return r}_getClassNode(){if(L.default.isClassDeclaration(this._node)||L.default.isClassExpression(this._node))return this._node;let r=this._node.declarationList.declarations[0]?.initializer;return!r||!L.default.isClassExpression(r)?null:r}};var _r={isNode:e=>ie(e),create:(e,t)=>[t.registerReflectedNode(e,()=>new pe(e,t))]};var me=class{constructor(t,r,i){this._node=t,this._value=r,this._context=i,this._jsDoc=new y(t)}getName(){return this._node.name.getText()??""}getValue(){return this._value}getContext(){return this._context}getLine(){return this._context.getLinePosition(this._node)}getTSNode(){return this._node}getJSDoc(){return this._jsDoc}serialize(){let t={name:this.getName(),value:this.getValue()};return o(t,"jsDoc",this.getJSDoc().serialize()),t}};var le=class{constructor(t,r){this._node=t,this._context=r,this._jsDoc=new y(this._node)}getNodeType(){return g.Declaration}getKind(){return x.Enum}getTSNode(){return this._node}getContext(){return this._context}getName(){return this._node.name.getText()??""}getLine(){return this._context.getLinePosition(this._node)}getNamespace(){return A(this._node)}getJSDoc(){return this._jsDoc}getMembers(){let t=0;return this._node.members.map(r=>{let i=r.initializer?.getText()??"";if(i!==""){let s=parseInt(i);isNaN(s)||(t=s+1,i=s)}else i=t++;let n=()=>new me(r,i,this._context);return this._context.registerReflectedNode(r,n)})}serialize(){let t={kind:this.getKind(),name:this.getName(),line:this.getLine()};return o(t,"namespace",this.getNamespace()),o(t,"members",this.getMembers().map(r=>r.serialize())),o(t,"jsDoc",this.getJSDoc().serialize()),t}};var xr=u(d(),1),Tr={isNode:e=>xr.default.isEnumDeclaration(e),create:(e,t)=>[t.registerReflectedNode(e,()=>new le(e,t))]};var Nr=[ur,_r,hr,Tr,cr,lr],Sr=[Re,Ve,Je];var S={ImportNode:e=>e.getNodeType()===g.Import,DefaultImportNode:e=>S.ImportNode(e)&&e.getKind()===P.Default,NamedImportNode:e=>S.ImportNode(e)&&e.getKind()===P.Named,NamespaceImportNode:e=>S.ImportNode(e)&&e.getKind()===P.Namespace,SideEffectImportNode:e=>S.ImportNode(e)&&e.getKind()===P.SideEffect,DeclarationNode:e=>e.getNodeType()===g.Declaration,EnumNode:e=>S.DeclarationNode(e)&&e.getKind()===x.Enum,VariableNode:e=>S.DeclarationNode(e)&&e.getKind()===x.Variable,TypeAliasNode:e=>S.DeclarationNode(e)&&e.getKind()===x.TypeAlias,FunctionNode:e=>S.DeclarationNode(e)&&e.getKind()===x.Function,ClassNode:e=>S.DeclarationNode(e)&&e.getKind()===x.Class,InterfaceNode:e=>S.DeclarationNode(e)&&e.getKind()===x.Interface,ArrayTypeNode:e=>e.getKind()===c.Array,ConditionalTypeNode:e=>e.getKind()===c.Conditional,FunctionTypeNode:e=>e.getKind()===c.Function,IndexedAccessTypeNode:e=>e.getKind()===c.IndexAccess,InferTypeNode:e=>e.getKind()===c.Infer,IntersectionTypeNode:e=>e.getKind()===c.Intersection,LiteralTypeNode:e=>e.getKind()===c.ObjectLiteral,MappedTypeNode:e=>e.getKind()===c.Mapped,NamedTupleMemberNode:e=>e.getKind()===c.NamedTupleMember,OptionalTypeNode:e=>e.getKind()===c.Optional,PrimitiveTypeNode:e=>e.getKind()===c.Intrinsic,RestTypeNode:e=>e.getKind()===c.Rest,TemplateLiteralTypeNode:e=>e.getKind()===c.TemplateLiteral,TupleTypeNode:e=>e.getKind()===c.Tuple,TypeLiteralNode:e=>e.getKind()===c.Literal,TypeOperatorNode:e=>e.getKind()===c.Operator,TypePredicateNode:e=>e.getKind()===c.Predicate,TypeQueryNode:e=>e.getKind()===c.Query,TypeReferenceNode:e=>e.getKind()===c.Reference,UnionTypeNode:e=>e.getKind()===c.Union,UnknownTypeNode:e=>e.getKind()===c.Unknown,ExportNode:e=>e.getNodeType()===g.Export,DefaultExportNode:e=>S.ExportNode(e)&&e.getKind()===b.Default,NamedExportNode:e=>S.ExportNode(e)&&e.getKind()===b.Named,EqualExportNode:e=>S.ExportNode(e)&&e.getKind()===b.Equals,NamespaceExportNode:e=>S.ExportNode(e)&&e.getKind()===b.Namespace,ReExportNode:e=>S.ExportNode(e)&&e.getKind()===b.Star};var ke=u(d(),1),ct=class{constructor(t,r){this._declarations=[],this._exports=[],this._imports=[],this._node=t,this._context=r,this._visitNode(t),this._removeNonPublicDeclarations()}getTSNode(){return this._node}getSourcePath(){return this._context.getSystem().normalizePath(this._node.fileName)}getOutputPath(){let t=this._node.fileName;if(t.endsWith("js"))return this._context.getSystem().normalizePath(t);if(t.endsWith(".d.ts"))return"";let r=this._context.getSystem(),i=r.getAbsolutePath(t),n=ke.default.getOutputFileNames(r.getCommandLine(),i,!1).filter(s=>s.endsWith(".js"))[0];return r.normalizePath(n)}getContext(){return this._context}getImports(){return this._imports}getExports(){return this._exports}getDeclarations(){return this._declarations}getDeclarationByKind(t){return this.getDeclarations().filter(r=>r.getKind()===t)}getDeclarationByName(t){return this.getDeclarations().find(r=>r.getName()===t)??null}getDeclarationsByCategory(t){return this.getDeclarations().filter(r=>r.getJSDoc()?.getTag(w.category)?.serialize()===t)}serialize(){return{sourcePath:this.getSourcePath(),outputPath:this.getOutputPath(),imports:this.getImports().map(t=>t.serialize()),declarations:this.getDeclarations().map(t=>t.serialize()),exports:this.getExports().map(t=>t.serialize())}}_visitNode(t){let r=!1;ce.isNode(t)&&this._add(ce.create(t,this._context));for(let i of Nr)i.isNode(t)&&(this._add(i.create(t,this._context)),r=!0);for(let i of Sr)i.isNode(t)&&this._add(i.create(t,this._context));r||ke.default.forEachChild(t,i=>this._visitNode(i))}_add(t){for(let r of t)S.ImportNode(r)&&this._imports.push(r),S.DeclarationNode(r)&&!this._hasDeclaration(r)&&this._declarations.push(r),S.ExportNode(r)&&!this._hasExport(r)&&this._exports.push(r)}_hasDeclaration(t){return this._declarations.some(r=>r.getName()===t.getName())}_hasExport(t){return S.ReExportNode(t)?this._exports.some(r=>S.ReExportNode(r)&&r.getModule()===t.getModule()):this._exports.some(r=>r.getName()===t.getName()&&r.getKind()===t.getKind())}_removeNonPublicDeclarations(){this._declarations=this._declarations.filter(t=>{let r=this._exports.findIndex(n=>n.getOriginalName()===t.getName()),i=!!t.getJSDoc()?.isIgnored();return r===-1?!1:(i&&this._exports.splice(r,1),!i)})}};var ue=class{constructor(t,r){this._modules=[],this._packageJson=null,this._modules=t.map(i=>new ct(i,r)),this._context=r,this._packageJson=this._getPackageJSON()}getContext(){return this._context}getModules(){return this._modules}has(t){let r=this._context.getSystem().normalizePath(t);return this._modules.some(i=>i.getSourcePath()===r)}add(t,r){let i=this._context.getSystem().normalizePath(t);if(this._modules.find(p=>p.getSourcePath()===i))throw new Error("File already exist");let s=this._context.upsertFile(i,r),a=new ct(s,this._context);return this._modules.push(a),a}update(t,r){let i=this._context.getSystem().normalizePath(t),n=this._context.getSystem().getAbsolutePath(i),s=this._modules.findIndex(l=>l.getSourcePath()===i);if(s<0)throw new Error("The file doesn't exist");let a=this._context.upsertFile(n,r),p=new ct(a,this._context);return this._modules.splice(s,1,p),p}getName(){return this._packageJson?.name??""}serialize(){return this._modules.map(t=>t.serialize())}_getPackageJSON(){let t=this._context.getSystem(),r=this._context.getOptions(),i=r.tsConfigFilePath?t.getDirName(r.tsConfigFilePath):t.getCurrentDirectory(),n=t.join(i,"package.json"),s=t.fileExists(n)?t.readFile(n):null;try{return s!=null?JSON.parse(s):null}catch{return null}}};var je=u(d(),1);async function hm(e,t={}){let r="/unknown.ts";if(!e)return{project:null,errors:[{messageText:"Source code is empty."}]};let i;t.system?(i=t.system,i.writeFile(r,e)):Fe?i=await import("./browser-system-EZST3GMG.js").then(q=>q.BrowserSystem.create({fsMap:new Map([[r,e]]),analyserOptions:t})):i=await import("./node-system-3CUFKIN5.js").then(q=>new q.NodeSystem({vfs:!0,fsMap:new Map([[r,e]]),analyserOptions:t}));let n=new yt(i.getCurrentDirectory()),s=i.getCommandLine(),a=i.getCompilerHost(),p=je.default.createProgram({rootNames:s.fileNames,options:s.options,host:a}),l=p.getSourceFile(r),T=je.default.getConfigFileParsingDiagnostics(s);if(n.addManyDiagnostics(T),s.errors.length>0)return{project:null,errors:n.getAll(),formattedDiagnostics:n.formatDiagnostics()};if(n.addManyDiagnostics(p.getSemanticDiagnostics()),n.addManyDiagnostics(p.getSyntacticDiagnostics()),!t.skipDiagnostics&&!n.isEmpty())return{project:null,errors:n.getAll(),formattedDiagnostics:n.formatDiagnostics()};if(!l)return n.addArgumentError("Unable to analyse source code."),{project:null,errors:n.getAll()};let D=new ft(i,p,n,t);return{project:new ue([l],D),errors:n.getAll(),formattedDiagnostics:n.formatDiagnostics()}}export{hm as a};
