import{a as f,b as Ot}from"./chunk-ZQUVYYHX.js";import{c as g}from"./chunk-BLPUKQJE.js";var Ft={experimentalDecorators:!0,target:"es2020",module:"ES2020",lib:["es2020","DOM"],declaration:!0,skipLibCheck:!0,skipDefaultLibCheck:!0},Mt={target:"es2020",module:"ES2020",lib:["es2020","DOM"],allowJs:!0,skipLibCheck:!0,skipDefaultLibCheck:!0,moduleResolution:"node",typeRoots:[]};var ee=g(f(),1);function ye(r,e){let{compilerOptions:t,jsProject:i,include:n,exclude:o}=e,s=["**node_modules**"];if(i)return ee.default.parseJsonConfigFileContent({compilerOptions:Mt,include:n??["**/*.js"],exclude:o??s},r,r.getCurrentDirectory());if(t)return ee.default.parseJsonConfigFileContent({compilerOptions:{...t,declaration:!0},include:n??["**/*.ts"],exclude:o??s},r,r.getCurrentDirectory());let c=Cr(r,e);return c||ee.default.parseJsonConfigFileContent({compilerOptions:Ft,include:n??["**/*.ts"],exclude:o??s},r,r.getCurrentDirectory())}function Cr(r,e){var t,i;let{tsConfigFilePath:n,include:o,exclude:s}=e,c=xt=>r.fileExists(xt),l=xt=>r.readFile(xt),y=n?r.isAbsolute(n)?r.getDirectoryName(n):r.getDirectoryName(r.getAbsolutePath(n)):r.getCurrentDirectory(),S=n?r.getBaseName(n):"tsconfig.json",D=ee.default.findConfigFile(y,c,S),F=D&&ee.default.readConfigFile(D,l);return!F||typeof F!="object"?null:(s!==void 0&&Array.isArray(s)&&((t=F.config).exclude??(t.exclude=[]),F.config.exclude.push(...s)),o!==void 0&&Array.isArray(o)&&((i=F.config).include??(i.include=[]),F.config.include.push(...o)),ee.default.parseJsonConfigFileContent(F.config,r,r.getDirectoryName(D),{},D))}var _e=g(f(),1),be=class{constructor(e){this._diagnostics=[],this._argumentErrors=[],this._cwd=e}formatDiagnostics(){let e={getCanonicalFileName:t=>t,getCurrentDirectory:()=>this._cwd,getNewLine:()=>`
`};return _e.default.formatDiagnosticsWithColorAndContext(this._diagnostics,e)}getAll(){return[...this._argumentErrors,..._e.default.sortAndDeduplicateDiagnostics(this._diagnostics)]}isEmpty(){return!this._diagnostics.length}flattenMessage(e){return _e.default.flattenDiagnosticMessageText(e.messageText,`
`)}addDiagnostic(e,t){let i={file:e.getSourceFile(),start:e.getStart(),length:e.getWidth(),category:_e.default.DiagnosticCategory.Error,messageText:t,code:1e6};this._diagnostics.push(i)}addArgumentError(e){this._argumentErrors.push({messageText:e})}addManyDiagnostics(e){this._diagnostics.push(...e)}};var Pe=g(f(),1),oe=class{constructor(e,t){this._system=e,this._options=t,this._cwd=e.getCurrentDirectory()}getSourceFile(e,t){let i=this.readFile(e,this._options.charset);return Pe.default.createSourceFile(e,i,t,!0)}getDefaultLibFileName(e){return Ot?Pe.default.getDefaultLibFileName(e):Pe.default.getDefaultLibFilePath(e)}writeFile(e,t,i){this._system.writeFile(e,t,i)}getCurrentDirectory(){return this._cwd}useCaseSensitiveFileNames(){return this._system.useCaseSensitiveFileNames}getCanonicalFileName(e){return this._system.useCaseSensitiveFileNames?e:e.toLowerCase()}getNewLine(){return this._system.newLine}fileExists(e){return this._system.fileExists(e)}readFile(e,t){return this._system.readFile(e,t)??""}directoryExists(e){return this._system.directoryExists(e)}getDirectories(e){return this._system.getDirectories(e)}readDirectory(e,t,i,n,o){return this._system.readDirectory(e,t,i,n,o)}realpath(e){return this._system.realpath(e)}};var Ce=g(f(),1),De=class{constructor(e,t,i,n,o){this._reflectedNodesBySymbol=new Map,this._system=e,this._getProgram=t,this._getCommandLine=i,this._diagnostics=n,this._options=o}getProgram(){return this._getProgram()}getCommandLine(){return this._getCommandLine()}getTypeChecker(){return this._getProgram().getTypeChecker()}getSystem(){return this._system}getDiagnostics(){return this._diagnostics}getOptions(){return this._options}registerReflectedNode(e,t){let i=this.getSymbol(e);if(!i)return t();let n=this._reflectedNodesBySymbol.get(i);return n||(n=t(),this._reflectedNodesBySymbol.set(i,n)),n}getSymbol(e){let t=this.getTypeChecker(),i=t.getSymbolAtLocation(e);for(!i&&this._isNamedNode(e)&&(i=t.getSymbolAtLocation(e.name));i&&i.flags&Ce.default.SymbolFlags.Alias;)i=t.getAliasedSymbol(i);return i||(i=e.symbol),i??null}getLocation(e){let t;"kind"in e?t=this.getSymbol(e):t=e.aliasSymbol??e.getSymbol();let i=t?.getDeclarations()?.[0],n=i?.getSourceFile(),o=n?.fileName?this._system.normalizePath(this._system.realpath(n.fileName)):"",s=i?this.getLinePosition(i):null;return{symbol:t,path:o,line:s}}getLinePosition(e){return e.getSourceFile().getLineAndCharacterOfPosition(e.getStart()).line+1}_isNamedNode(e){let t=e.name;return!!t&&(Ce.default.isMemberName(t)||Ce.default.isComputedPropertyName(t))}};var Tt=g(f(),1),we=()=>typeof Tt.default.canHaveDecorators=="function"&&typeof Tt.default.canHaveModifiers=="function";var St=g(f(),1);function xe(r){return we()?St.default.canHaveModifiers(r)?St.default.getModifiers(r)??[]:[]:Array.from(r.modifiers??[])}var kt=g(f(),1);function It(r){return xe(r).some(e=>e.kind===kt.default.SyntaxKind.ExportKeyword)}function jt(r){return xe(r).some(e=>e.kind===kt.default.SyntaxKind.DefaultKeyword)}var w;(function(r){r.Default="Default",r.Namespace="Namespace",r.Star="Star",r.Named="Named",r.Equals="Equals"})(w||(w={}));var x;(function(r){r.Import="Import",r.Declaration="Declaration",r.Export="Export"})(x||(x={}));var Te=class{constructor(e,t,i){this._declaration=null,this._node=e,this._declaration=i??null,this._context=t}getName(){return this._declaration?this._declaration.name.getText()??"":this._node.name?.getText()??""}getFullyQualifiedName(){let e=this._declaration??this._node,t=this._context.getSymbol(e);return t?this._context.getTypeChecker().getFullyQualifiedName(t).split(".").slice(1).join("."):this.getName()}getOriginalName(){return this.getName()}getNodeType(){return x.Export}getContext(){return this._context}getKind(){return jt(this._node)?w.Default:w.Named}getTSNode(){return this._node}serialize(){return{name:this.getFullyQualifiedName(),kind:this.getKind()}}};var Ae=class{constructor(e,t){this._node=e,this._context=t}getName(){return this._node.expression.getText()??""}getOriginalName(){return this.getName()}getNodeType(){return x.Export}getContext(){return this._context}getKind(){return this._node.isExportEquals?w.Equals:w.Default}isTypeOnly(){return!1}getTSNode(){return this._node}serialize(){return{name:this.getName(),kind:this.getKind()}}};function a(r,e,t){r==null||t==null||(typeof t=="boolean"?t&&(r[e]=t):typeof t=="string"?t!==""&&(r[e]=t):Array.isArray(t)?t.length&&(r[e]=t):Dr(t)?Object.keys(t).length&&(r[e]=t):r[e]=t)}function Dr(r){return r!=null&&Object.prototype.toString.call(r)==="[object Object]"}var Rt=g(f(),1),ze=class{constructor(e,t){this._node=e,this._context=t}getName(){return!this._node.exportClause||!Rt.default.isNamespaceExport(this._node.exportClause)?"":this._node.exportClause.name.escapedText??""}getOriginalName(){return this.getName()}getContext(){return this._context}getKind(){return w.Namespace}getNodeType(){return x.Export}getModule(){return this._node.moduleSpecifier?.getText()??""}getTSNode(){return this._node}isTypeOnly(){return this._node.isTypeOnly}serialize(){let e={name:this.getName(),kind:this.getKind()};return a(e,"module",this.getModule()),a(e,"typeOnly",this.isTypeOnly()),e}};var Ke=class{constructor(e,t,i){this._node=e,this._element=t,this._context=i}getName(){return this._element.name.escapedText??""}getOriginalName(){return this._element.propertyName?.escapedText??this.getName()}getKind(){return w.Named}getNodeType(){return x.Export}getContext(){return this._context}isTypeOnly(){return!!this._node.isTypeOnly}getModule(){return this._node.moduleSpecifier?.getText()??""}getTSNode(){return this._node}isReexport(){return this.getOriginalName()!==this.getName()}serialize(){let e=this.getOriginalName(),t={name:this.getName(),kind:this.getKind()};return e!==t.name&&a(t,"originalName",this.getOriginalName()),a(t,"typeOnly",this.isTypeOnly()),a(t,"module",this.getModule()),t}};var Ee=class{constructor(e,t){this._node=e,this._context=t}getName(){return"*"}getOriginalName(){return this.getName()}getKind(){return w.Star}getNodeType(){return x.Export}getContext(){return this._context}getModule(){return this._node.moduleSpecifier?.getText()??""}getTSNode(){return this._node}isTypeOnly(){return!!this._node.isTypeOnly}serialize(){let e={name:this.getName(),kind:this.getKind()};return a(e,"module",this.getModule()),a(e,"typeOnly",this.isTypeOnly()),e}};var R=g(f(),1),Bt={isNode:r=>It(r),create:(r,e)=>{let t=[];if(R.default.isVariableStatement(r))for(let i of r.declarationList.declarations)t.push(new Te(r,e,i));return(R.default.isFunctionDeclaration(r)||R.default.isClassDeclaration(r)||R.default.isInterfaceDeclaration(r)||R.default.isEnumDeclaration(r)||R.default.isTypeAliasDeclaration(r))&&t.push(new Te(r,e)),t}},vt={isNode:r=>R.default.isExportAssignment(r),create:(r,e)=>[new Ae(r,e)]},Vt={isNode:r=>R.default.isExportDeclaration(r),create:(r,e)=>{let t=r.exportClause&&R.default.isNamedExports(r.exportClause),i=r.exportClause&&R.default.isNamespaceExport(r.exportClause),n=r.moduleSpecifier!==void 0,o=[];if(t)for(let s of r.exportClause.elements)o.push(new Ke(r,s,e));else i?o.push(new ze(r,e)):n&&o.push(new Ee(r,e));return o}};var P;(function(r){r.Class="Class",r.Interface="Interface",r.Function="Function",r.Mixin="Mixin",r.Variable="Variable",r.Enum="Enum",r.TypeAlias="TypeAlias"})(P||(P={}));var m;(function(r){r.Array="Array",r.Union="Union",r.Intersection="Intersection",r.ObjectLiteral="ObjectLiteral",r.Conditional="Conditional",r.Reference="Reference",r.Intrinsic="Intrinsic",r.Tuple="Tuple",r.NamedTupleMember="NamedTupleMember",r.Operator="Operator",r.Unknown="Unknown",r.IndexAccess="IndexAccess",r.Literal="Literal",r.Function="Function",r.Query="Query",r.Infer="Infer",r.Mapped="Mapped",r.Optional="Optional",r.Predicate="Predicate",r.Rest="Rest",r.TemplateLiteral="TemplateLiteral"})(m||(m={}));var Le=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.TemplateLiteral}getText(){return this._context.getTypeChecker().typeToString(this._type)}serialize(){return{text:this.getText(),kind:this.getKind()}}};var Jt=r=>Array.isArray(r)&&r.length>0;var Nt=g(f(),1);function Q(r){return!!r.replace(/'/g,"")[0]?.match(/[@a-zA-Z\d]/g)}function K(r){return r.length<1e3&&(/.*node_modules\/.+/.test(r)||/^https?:\/\/.+/.test(r))}function se(r,e){if(!r)return"";let n=e.getSymbol(r)?.declarations?.[0]?.getSourceFile().fileName??"";return e.getSystem().normalizePath(n)}function ae(r,e){let t=e.paths??{};for(let i in t){let n=new RegExp(i);if(r.length<1e3&&n.test(r))return!0}return!1}function Ut(r){return!!r.importClause?.name}function bt(r){let e=r.importClause?.namedBindings;return!e||!Nt.default.isNamedImports(e)?!1:Jt(e.elements)}function qt(r){let e=r.importClause?.namedBindings;return!e||!Nt.default.isNamespaceImport(e)?!1:!!e.name&&!bt(r)}function Wt(r){return Object.prototype.hasOwnProperty.call(r,"importClause")&&r.importClause==null}var $t=g(f(),1),Oe=class{constructor(e,t,i){this._loc=null,this._node=e,this._type=t,this._context=i,$t.default.isTypeReferenceNode(e.objectType)&&(this._loc=i.getLocation(e.objectType.typeName))}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.IndexAccess}getText(){return`${this.getObjectType().getText()}[${this.getIndexType().getText()}]`}getPath(){return this._loc?.path??""}getLine(){return this._loc?.line??null}getObjectType(){return u(this._node.objectType,this._context)}getIndexType(){return u(this._node.indexType,this._context)}serialize(){let e={text:this.getText(),kind:this.getKind()},t={},i=this.getPath(),n=this.getLine();return n!=null&&!K(i)&&(t.line=n,t.path=i),a(e,"source",t),e}};var Fe=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.NamedTupleMember}getText(){return`${this.getName()}: ${this.getType().getText()}`}getName(){return this._node.name.getText()??""}getType(){return u(this._node.type,this._context)}isOptional(){return!!this._node.questionToken}serialize(){let e={name:this.getName(),...this.getType().serialize()};return a(e,"optional",this.isOptional()),e}};var Me=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Intersection}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getElements(){return this._node.types.map(e=>u(e,this._context))}serialize(){return{text:this.getText(),kind:this.getKind(),elements:this.getElements().map(e=>e.serialize())}}};var Ie=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Conditional}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getCheckType(){return u(this._node.checkType,this._context)}getExtendsType(){return u(this._node.extendsType,this._context)}getTrueType(){return u(this._node.trueType,this._context)}getFalseType(){return u(this._node.falseType,this._context)}serialize(){return{text:this.getText(),kind:this.getKind()}}};var J=g(f(),1),L=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Intrinsic}getText(){switch(this._node.kind){case J.default.SyntaxKind.NumberKeyword:return"number";case J.default.SyntaxKind.BooleanKeyword:return"boolean";case J.default.SyntaxKind.StringKeyword:return"string";case J.default.SyntaxKind.UndefinedKeyword:return"undefined";case J.default.SyntaxKind.NullKeyword:return"null";case J.default.SyntaxKind.ObjectKeyword:return"object";case J.default.SyntaxKind.SymbolKeyword:return"symbol";case J.default.SyntaxKind.BigIntKeyword:return"bigint";case J.default.SyntaxKind.VoidKeyword:return"void";default:return this._context.getTypeChecker().typeToString(this._type)??""}}serialize(){return{text:this.getText(),kind:this.getKind()}}};var Pt=g(f(),1),je=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i,this._loc=i.getLocation(e.typeName)}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Reference}getText(){if(!(this._type.flags&Pt.default.TypeFlags.Any))return this._context.getTypeChecker().typeToString(this._type);let e=Pt.default.isIdentifier(this._node.typeName)?this._node.typeName.text:this._node.typeName.right.text,t=this.getTypeArguments().map(i=>i.getText());return t.length>0?`${e}<${t.join(", ")}>`:e}getPath(){return this._loc.path}getLine(){return this._loc.line}getTypeArguments(){return(this._node.typeArguments??[]).map(e=>u(e,this._context))}serialize(){let e={text:this.getText(),kind:this.getKind()},t={},i=this.getPath(),n=this.getLine();return!K(i)&&n!=null&&(t.line=n,t.path=i),a(e,"source",t),a(e,"typeArguments",this.getTypeArguments().map(o=>o.serialize())),e}};var Ht=g(f(),1),Re=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Predicate}getText(){let e=Ht.default.isThisTypeNode(this._node.parameterName)?"this":this._node.parameterName.getText(),t=this.asserts()?["asserts",e]:[e],i=this.getTargetType();return i&&t.push("is",i.getText()),t.join(" ")}getTargetType(){return this._node.type?u(this._node.type,this._context):null}asserts(){return!!this._node.assertsModifier}serialize(){return{text:this.getText(),kind:this.getKind()}}};var Be=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Operator}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getElementType(){return u(this._node.type,this._context)}serialize(){return{text:this.getText(),kind:this.getKind(),elementType:this.getElementType().serialize()}}};var C=g(f(),1);function O(r,e){let t=r;if(t==null)return;if((C.default.isAsExpression(t)||C.default.isTypeAssertionExpression(t)||C.default.isParenthesizedExpression(t)||C.default.isComputedPropertyName(t))&&(t=t.expression),C.default.isPrefixUnaryExpression(t))return Kr(t,e);if(t==null)return;let i=t.getText()??"";if(C.default.isStringLiteralLike(t)||C.default.isArrayLiteralExpression(t)||C.default.isObjectLiteralExpression(t))return i;if(C.default.isNumericLiteral(t))return Ar(i);if(wr(t))return i==="true";if(t.kind===C.default.SyntaxKind.NullKeyword)return null;if(t.kind!==C.default.SyntaxKind.UndefinedKeyword)return C.default.isIdentifier(t)||C.default.isPropertyAccessExpression(t)?zr(t,e):i}function wr(r){return r.kind===C.default.SyntaxKind.FalseKeyword||r.kind===C.default.SyntaxKind.TrueKeyword}function Ar(r){let e=parseFloat(r);return isNaN(e)?r:e}function zr(r,e){let t=e.getSymbol(r),i=r.getText()??"",n=t?.declarations?.[0],o=n?.getSourceFile().fileName??"",s=o?e.getSystem().realpath(o):"";return n==null||K(s)?i:C.default.isVariableDeclaration(n)||C.default.isPropertyDeclaration(n)?O(n.initializer,e):i}function Kr(r,e){let t=O(r.operand,e);if(typeof t!="number"&&typeof t!="string"&&typeof t!="boolean")return t;switch(r.operator){case C.default.SyntaxKind.MinusToken:return-t;case C.default.SyntaxKind.ExclamationToken:return!t;case C.default.SyntaxKind.PlusToken:return+t;default:return t}}var ve=class{constructor(e,t){this._node=e,this._context=t}getTSNode(){return this._node}getContext(){return this._context}getName(){return this._node.name.getText()||""}getDefault(){return O(this._node.initializer,this._context)}serialize(){let e={name:this.getName()};return a(e,"default",this.getDefault()),e}};var Ct=g(f(),1);function M(r){let e;return we()?e=Ct.default.canHaveDecorators(r)?Ct.default.getDecorators(r)??[]:[]:e=r.decorators??[],e}function te(r){let e=[r(0)],t=[];return{next(i){t.push(i);let n=e[e.length-1],o=n.next(i);if(o.kind==="backtrack"){if(!n.isValid())return e.pop(),{kind:"backtrack",tokens:t};let s=r(e.length),c=o.tokens,l,y=0;for(let S=0;S<c.length;S++){let D=c[S];if(l=s.next(D),y=S,l.kind==="error"||l.kind==="success")break;if(l.kind==="backtrack"){y-=l.tokens.length-1;break}}return l?.kind==="error"?{kind:"backtrack",tokens:o.tokens}:((s.isValid()||l?.kind==="in-progress")&&(t=c,e.push(s)),y===c.length-1?l:{kind:"backtrack",tokens:c.slice(y)})}if(o.kind==="error"){let s=e.length;return e.pop(),s>1?{kind:"backtrack",tokens:t}:o}return o.kind==="success"&&(e.push(r(e.length)),t=[]),{kind:"in-progress"}},isValid(){return e.length>0&&!!e[0]?.isValid()},serialize(){return e.flatMap(i=>i.serialize())}}}function N(r){let e=[],t=!0;return{next(i){e.push(i);let n=r.next(i);return n.kind==="error"?(t=!1,{kind:"backtrack",tokens:e}):n},isValid(){return t},serialize(){return t?r.serialize():[]}}}var A=(d=>(d[d.Newline=0]="Newline",d[d.Spaces=1]="Spaces",d[d.AsciiWord=2]="AsciiWord",d[d.Slash=3]="Slash",d[d.Star=4]="Star",d[d.Backslash=5]="Backslash",d[d.DoubleQuote=6]="DoubleQuote",d[d.Tilde=7]="Tilde",d[d.AtSign=8]="AtSign",d[d.LeftCurlyBracket=9]="LeftCurlyBracket",d[d.RightCurlyBracket=10]="RightCurlyBracket",d[d.Backtick=11]="Backtick",d[d.Period=12]="Period",d[d.Colon=13]="Colon",d[d.Pipe=14]="Pipe",d[d.PoundSymbol=15]="PoundSymbol",d[d.RightSquareBracket=16]="RightSquareBracket",d[d.LeftSquareBracket=17]="LeftSquareBracket",d[d.Equal=18]="Equal",d[d.Hyphen=19]="Hyphen",d[d.Other=20]="Other",d))(A||{}),Se=class{constructor(e,t,i,n,o,s){this._kind=e,this._lexeme=t,this._multiple=i,this._line=n,this._start=o,this._end=s}get kind(){return this._kind}get start(){return this._start}get end(){return this._end}get line(){return this._line}get length(){return this._end-this._start}get multiple(){return this._multiple}merge(e){this._end=e.end,this._lexeme=`${this._lexeme}${e.toString()}`}toString(){return this._lexeme}};function p(r,e){let t=null;return{next(i){let n=e?.length==null||i.length===e.length;return i.kind===r&&n?(t=i,{kind:"success"}):{kind:"error",error:{line:i.line,start:i.start,end:i.end,message:`Expected token of kind "${A[r]}" but instead found "${A[i.kind]}".`}}},isValid(){return!!t},serialize(){let i=t?.toString()??"";return e?.serializable&&i?[{kind:"text",text:i}]:[]}}}function G(r){let e=r.reduce((i,n,o)=>(i[o]={valid:!0,finalized:!1,backtrackTokens:[]},i),{}),t=null;return{next(i){for(let s=0;s<r.length;s++){let c=e[s],l=r[s],y=t!=null?r[t]:null;(t!=null?e[t]:null)?.valid||(t=null),Er(i,l,c),c.finalized&&c.valid&&(!y||y.priority<l.priority)&&(t=s)}let n=Object.values(e);if(n.every(s=>!s.valid))return{kind:"error",error:e[0]?.error};if(t==null||n.some(s=>s.valid&&!s.finalized))return{kind:"in-progress"};let o=e[t];return o.backtrackTokens.length>0?{kind:"backtrack",tokens:o.backtrackTokens}:{kind:"success"}},isValid(){return t!=null&&!!e[t]?.valid},serialize(){return t==null?[]:r[t].symbol.serialize()}}}function Er(r,e,t){if(!t.valid)return;if(t.finalized){t.backtrackTokens.push(r);return}let i=e.symbol,n=i.next(r);if(n.kind!=="in-progress"){if(n.kind==="success"){t.valid=!0,t.finalized=!0;return}if(n.kind==="error"){t.valid=!1,t.error=n.error;return}t.finalized=!0,t.valid=i.isValid(),t.backtrackTokens=n.tokens}}function W(r){let e=[],t=!0;return{next(i){e.push(i);let n=0;for(let{kinds:s,canEscape:c}of r){if(e.length<s.length)continue;let l=c&&e[e.length-s.length-1]?.kind===5;if(s.every((S,D)=>e[e.length-s.length+D]?.kind===S)&&!l){n=s.length;break}}if(!n)return{kind:"in-progress"};let o=e.slice(e.length-n);return e=e.slice(0,e.length-n),t=e.length>0,{kind:"backtrack",tokens:o}},isValid(){return t},serialize(){return t?[{kind:"text",text:e.map(i=>i.toString()).join("").trim()}]:[]}}}function Qt(){let r=G([{symbol:Lr(),priority:0},{symbol:Or(),priority:0}]);return{next(e){return r.next(e)},isValid(){return r.isValid()},serialize(){return r.serialize()}}}function Lr(){let r=[p(17),W([{kinds:[8],canEscape:!0},{kinds:[4,3]},{kinds:[9],canEscape:!0},{kinds:[16],canEscape:!0}]),p(16),p(9),p(8),p(2,{serializable:!0}),p(1),W([{kinds:[8],canEscape:!0},{kinds:[4,3]},{kinds:[17],canEscape:!0},{kinds:[10],canEscape:!0}]),p(10)],e=0,t=!0;return{next(i){let o=r[e].next(i);if(o.kind==="backtrack"){if(e++,e===r.length-1){let l={kind:"error",error:{line:i.line,start:i.start,end:i.end,message:`Unexpected token found "${A[i.kind]}"`}};return o.tokens.length===1?this.next(o.tokens[0]):l}let s,c=o.tokens.length-1;for(let l=0;l<=c;l++){let y=o.tokens[l];if(s=this.next(y),s.kind==="error")return s;if(s.kind==="success"&&l<c)return{kind:"backtrack",tokens:o.tokens.slice(l+1)}}return s}return o.kind==="error"?(t=!1,o):(o.kind==="success"&&e++,e===r.length?(t=!0,{kind:"success"}):{kind:"in-progress"})},isValid(){return t},serialize(){if(!t)return[];let i=r[5].serialize()[0]?.text??"",n=r[7].serialize()[0]?.text??"",o=r[1].serialize()[0]?.text??"";return[{kind:i,target:n,targetText:o}]}}}function Or(){let r=[p(9),p(8),p(2,{serializable:!0}),W([{kinds:[8],canEscape:!0},{kinds:[14],canEscape:!0},{kinds:[4,3]},{kinds:[10],canEscape:!0}]),N(p(1)),N(p(14)),N(p(1)),W([{kinds:[8],canEscape:!0},{kinds:[14],canEscape:!0},{kinds:[4,3]},{kinds:[10],canEscape:!0}]),p(10)],e=0,t=!0;return{next(i){let o=r[e].next(i);if(o.kind==="backtrack"){if(e++,e===r.length-1){let l={kind:"error",error:{line:i.line,start:i.start,end:i.end,message:`Unexpected token found "${A[i.kind]}"`}};return o.tokens.length===1?this.next(o.tokens[0]):l}if(e!==4)return this.next(o.tokens[0]);let s,c=o.tokens.length-1;for(let l=0;l<=c;l++){let y=o.tokens[l];if(s=this.next(y),s.kind==="error")return s;if(s.kind==="success"&&l<c)return{kind:"backtrack",tokens:o.tokens.slice(l+1)}}return s}return o.kind==="error"?(t=!1,o):(o.kind==="success"&&e++,e===r.length?(t=!0,{kind:"success"}):{kind:"in-progress"})},isValid(){return t},serialize(){if(!t)return[];let i=r[2].serialize()[0]?.text??"",n=r[3].serialize()[0]?.text??"",o=r[7].serialize()[0]?.text??"";return[{kind:i,target:n,targetText:o}]}}}function Dt(r){let e=[],t=!1;return{next(i){return e.push(i),e.length<r.length?{kind:"in-progress"}:e.length===r.length&&e.every((o,s)=>r[s]===o.kind)?(t=!1,{kind:"error",error:{line:i.line,start:i.start,end:i.end,message:`Unexpected token of kind "${A[i.kind]}".`}}):(t=!0,{kind:"backtrack",tokens:e})},isValid(){return t},serialize(){return[]}}}function Gt(){let r=te(e=>wt({startPadding:!0,standaloneLine:e>0}));return{next(e){return r.next(e)},isValid(){return r.isValid()},serialize(){let e=At(r.serialize());return e.length?[{kind:"description",text:e}]:[]}}}function wt(r){let e=[r.startPadding?p(1,{length:1}):N(p(1,{length:1})),Dt([4,3]),r.standaloneLine?p(4):N(p(4)),N(p(1)),Dt([8]),N(te(()=>G([{priority:0,symbol:W([{kinds:[17],canEscape:!0},{kinds:[9],canEscape:!0},{kinds:[0]},{kinds:[4,3]},{kinds:[8],canEscape:!0}])},{priority:1,symbol:Qt()}]))),N(p(0,{serializable:!0}))],t=0,i=!1,n=[];return{next(o){n.push(o);let c=e[t].next(o);if(c.kind==="backtrack"){if(t++,t===e.length)return i=!0,c;if(t===e.length-1){let S=c.tokens[0],D=c.tokens.length>1;return S.kind===8?(i=!1,{kind:"backtrack",tokens:n}):D?(i=!0,c):this.next(S)}if(t!==2)return this.next(c.tokens[0]);n=n.slice(0,n.length-c.tokens.length);let l,y=c.tokens.length-1;for(let S=0;S<=y;S++){let D=c.tokens[S];if(l=this.next(D),l.kind==="success"&&S<y)return{kind:"backtrack",tokens:c.tokens.slice(S+1)}}return l}return c.kind==="error"?(i=!1,{kind:"backtrack",tokens:n}):(c.kind==="success"&&t++,t===e.length?(i=!0,{kind:"success"}):{kind:"in-progress"})},isValid(){return i},serialize(){return e.flatMap(o=>o.serialize())}}}function At(r){let e=[];if(r.every(n=>n.kind==="text"&&(n.text===""||n.text===`
`)))return[];for(let n=0;n<r.length;n++){let o=r[n],s=e[e.length-1],c=n===r.length-1,l=typeof o.text=="string"&&o.text===`
`;if(!(l&&c)){if(o.kind==="text"&&s?.kind==="text"){let y=s.text??"",S=y.endsWith(`
`),D=l&&S?"":o.text??"";s.text=y+D;continue}e.push(o)}}if(e.length===1&&e[0]?.kind==="text")return(e[0]?.text??"").replace(/^\n+|\n+$/,"");let i=e[e.length-1];return i.kind==="text"&&(i.text=(i.text??"").replace(/\n+$/,"")),e}function Xt(){let r=[p(1,{length:1}),p(4),N(p(1)),p(0)],e=[],t=0,i=!1;return{next(n){e.push(n);let s=r[t].next(n);if(s.kind==="backtrack"){t++;let c=s.tokens[0];return e.pop(),this.next(c)}return s.kind==="error"?(i=!1,{kind:"backtrack",tokens:e}):(s.kind==="success"&&t++,t===r.length?(i=!0,{kind:"success"}):{kind:"in-progress"})},isValid(){return i},serialize(){return[]}}}var Fr=["access","author","default","defaultvalue","description","example","exception","file","fileoverview","kind","license","overview","return","returns","since","summary","throws","version","variation"];function Yt(){let r=[p(1,{length:1}),N(p(4)),N(p(1)),p(8),p(2,{serializable:!0}),N(p(1)),N(Mr()),N(p(1)),N(G([{symbol:p(2,{serializable:!0}),priority:0},{symbol:Ir(),priority:1}])),N(p(1)),N(p(19)),N(p(1)),N(te(t=>wt({startPadding:t>0,standaloneLine:t>0})))],e=0;return{next(t){let n=r[e].next(t);if(n.kind==="backtrack"){if(e++,e===r.length)return n;if(e!==7&&e!==9)return this.next(n.tokens[0]);let o;for(let s=0;s<n.tokens.length;s++){let c=n.tokens[s];if(o=this.next(c),o.kind==="error")return n;if(o.kind==="backtrack")return{kind:"backtrack",tokens:o.tokens.concat(n.tokens.slice(s+1))}}return o}return n.kind==="error"?n:(n.kind==="success"&&e++,{kind:"in-progress"})},isValid(){return e>4},serialize(){if(e<=4)return[];let t={},i=r[4]?.serialize()[0]?.text??"",n=r[6]?.serialize()[0]?.text??"",o=r[8]?.serialize()[0],s=!!o?.optional,c=o?.default??"",l=(o?.name??"")||(o?.text??""),y=At(r[r.length-1]?.serialize()??[]);return Fr.includes(i)&&(y=typeof y=="string"?[l,y].join(" ").trim():[{kind:"text",text:l},...y],l=""),Array.isArray(y)&&!y.length&&(y=""),t.kind=i,l&&(t.name=l),y&&(t.text=y),n&&(t.type=n),s&&(t.optional=!0),c&&(t.default=c),[t]}}}function Mr(){let r=[],e=0,t=!0;return{next(i){return r.push(i),i.kind===9?(e++,{kind:"in-progress"}):e?i.kind===10?(e--,e>0?{kind:"in-progress"}:(t=!0,{kind:"success"})):{kind:"in-progress"}:(t=!1,{kind:"error",error:{line:i.line,start:i.start,end:i.end,message:`Expected a left curly bracket but found "${A[i.kind]}"`}})},isValid(){return t},serialize(){return t?[{kind:"text",text:r.slice(1,-1).map(i=>i.toString()).join("").trim()}]:[]}}}function Ir(){let r=[p(17),p(2,{serializable:!0}),jr(),p(16)],e=[],t=0,i=!0;return{next(n){e.push(n);let s=r[t].next(n);return s.kind==="backtrack"?(t++,i=!0,s.tokens.length>1?{kind:"backtrack",tokens:e}:this.next(s.tokens[0])):s.kind==="error"?(i=!1,{kind:"backtrack",tokens:e}):(s.kind==="success"&&t++,t===r.length?(i=!0,{kind:"success"}):{kind:"in-progress"})},isValid(){return i},serialize(){if(!i)return[];let n=r[1].serialize()[0]?.text??"",o=r[2].serialize()[0]?.text??"";return[{name:n,default:o,optional:!0}]}}}function jr(){let r=[p(18),W([{kinds:[0]},{kinds:[4,3]},{kinds:[8],canEscape:!0},{kinds:[16],canEscape:!0}])],e=[],t=0,i=!0;return{next(n){e.push(n);let s=r[t].next(n);return s.kind==="backtrack"?(t++,i=!0,s):s.kind==="error"?(i=!1,{kind:"backtrack",tokens:e}):(s.kind==="success"&&t++,t===r.length?(i=!0,{kind:"success"}):{kind:"in-progress"})},isValid(){return i},serialize(){return i?[{text:r[1].serialize()[0]?.text??""}]:[]}}}function Zt(){let r=[p(3),p(4),p(4),N(p(0)),N(Gt()),N(te(()=>G([{priority:0,symbol:Xt()},{priority:1,symbol:Yt()}]))),N(p(1,{length:1})),p(4),p(3)],e=0;return{next(t){let i=r[e];if(!i)return{kind:"error",error:{start:t.start,end:t.end,line:t.line,message:`Unexpected token found at the end of the comment: "${A[t.kind]}"`}};let n=i.next(t);if(n.kind==="error")return n;if(n.kind==="backtrack"){e++;let o=n.tokens;for(let s of o)if(n=this.next(s),n.kind==="error")return n}else n.kind==="success"&&e++;return e<r.length?{kind:"in-progress"}:{kind:"success"}},isValid(){return e===r.length},serialize(){let t=[];for(let i of r)t.push(...i.serialize());return t}}}var Rr=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","_"],Br=[" ","	","\f"],er={47:{kind:3,multiple:!1},42:{kind:4,multiple:!1},35:{kind:15,multiple:!1},34:{kind:6,multiple:!1},46:{kind:12,multiple:!1},64:{kind:8,multiple:!1},96:{kind:11,multiple:!1},123:{kind:9,multiple:!1},125:{kind:10,multiple:!1},124:{kind:14,multiple:!1},126:{kind:7,multiple:!1},58:{kind:13,multiple:!1},61:{kind:18,multiple:!1},91:{kind:17,multiple:!1},93:{kind:16,multiple:!1},45:{kind:19,multiple:!1},92:{kind:5,multiple:!1},10:{kind:0,multiple:!1},...Rr.reduce((r,e)=>(r[e.charCodeAt(0)]={kind:2,multiple:!0},r),{}),...Br.reduce((r,e)=>(r[e.charCodeAt(0)]={kind:1,multiple:!0},r),{})};function*tr(r){let e=r.trim().replace(/\r\n/g,`
`),t=e.length,i=0,n=0,o=0,s=[],c=null,l=null;for(;i<t;){let y=e.charCodeAt(i),S=e[i],D=er[y],F=i-o;if(D!==void 0?c=new Se(D.kind,S,D.multiple,n,F,F+1):c=new Se(20,S,!0,n,F,F+1),i+=c.length,l&&l.multiple&&c.kind===l.kind?(l.merge(c),c=l):(l&&(yield l),s.push(c),l=c),c.kind===0&&(n++,o=i+1,s=[]),vr(s)){yield l;break}}}function vr(r){let e=r.length;return r[e-1]?.kind===3&&r[e-2]?.kind===4}function rr(r){let e=Zt(),t=null;for(let i of tr(r))if(t=e.next(i),t.kind==="error")return{error:t.error,parts:[]};return t?.kind!=="success"?{parts:[],error:{line:0,start:0,end:r.length,message:"Unbalanced comment"}}:{error:null,parts:e.serialize()}}var Ve=g(f(),1),k=class{constructor(e){this._parts=[],this._parseComments(e)}hasTag(e){return this._parts.some(t=>t.kind===e)}getTag(e){return this._parts.find(t=>t.kind===e)}getAllTags(e){return this._parts.filter(t=>t.kind===e)}isIgnored(){return this._parts.some(e=>e.kind==="ignore"||e.kind==="internal"||e.kind==="private")}serialize(){return this._parts}_parseComments(e){let t=Ve.default.isSourceFile(e),i,n;if(t?(n=Ve.default.forEachChild(e,s=>s),i=e.text):(n=e,i=e.getSourceFile()?.text),!i||!n)return;let o=Ve.default.getLeadingCommentRanges(i,n.pos)??[];if(o.length){t?o=o.slice(0,o.length>1?-1:1):o=[o[o.length-1]];for(let s of o){let c=i.substring(s.pos,s.end);c=c.split(/\r\n|\n/).map(S=>S.replace(/^\s+/," ")).join(`
`);let l;try{l=rr(c)}catch{}if(!l||l.error)continue;let y=l.parts.some(S=>S.kind==="module"||S.kind==="fileoverview"||S.kind==="packageDocumentation");!t&&y||o.length===1&&t&&!y||(this._parts=this._parts.concat(l.parts))}}}};var ke=g(f(),1),E=class{constructor(e,t){this._decorator=e,this._context=t,this._jsDoc=new k(e)}getName(){let e=this._decorator.expression;return ke.default.isCallExpression(e)&&(e=e.expression),e.getText()}getTSNode(){return this._decorator}getContext(){return this._context}getJSDoc(){return this._jsDoc}hasArguments(){return!!this.getArguments().length}getArguments(){let e=this._decorator.expression;return ke.default.isCallExpression(e)?e.arguments.map(t=>O(t,this._context)):[]}getLine(){let e=this._decorator.expression;return ke.default.isCallExpression(e)?this._context.getLocation(e.expression).line:this._context.getLocation(e).line}getPath(){let e=this._decorator.expression;return ke.default.isCallExpression(e)?this._context.getLocation(e.expression).path:this._context.getLocation(e).path}serialize(){let e=this.getPath(),t=this.getLine(),i={name:this.getName()};return t!=null&&(i.source={path:e,line:t}),a(i,"jsDoc",this.getJSDoc().serialize()),a(i,"arguments",this.getArguments()),i}};var zt=g(f(),1),X=class{constructor(e,t,i){this._node=e,this._symbol=t,this._context=i,this._jsDoc=new k(this._node)}getName(){return this.isNamed()?"__namedParameter":this._symbol?this._symbol.getName()??"":this._node.name.getText()??""}getTSNode(){return this._node}getContext(){return this._context}getLine(){return this._context.getLinePosition(this._node)}getType(){let e=this._context.getTypeChecker(),t=this._symbol?e.getTypeOfSymbolAtLocation(this._symbol,this._node):null;return t?u(t,this._context):ce(this._node,this._context)}getDefault(){return O(this._node.initializer,this._context)}getDecorators(){return M(this._node).map(e=>new E(e,this._context))}getNamedElements(){if(!this.isNamed())return[];let e=this._node.name.elements??[],t=[];for(let i of e)t.push(new ve(i,this._context));return t}getJSDoc(){return this._jsDoc}isNamed(){return zt.default.isObjectBindingPattern(this._node.name)}isRest(){return!!(this._node.dotDotDotToken&&this._node.type?.kind===zt.default.SyntaxKind.ArrayType)}isOptional(){return!!this._context.getTypeChecker().isOptionalParameter(this._node)}serialize(){let e={name:this.getName(),type:this.getType().serialize(),line:this.getLine()};return a(e,"decorators",this.getDecorators().map(t=>t.serialize())),a(e,"jsDoc",this.getJSDoc().serialize()),a(e,"optional",this.isOptional()),a(e,"rest",this.isRest()),a(e,"named",this.isNamed()),a(e,"default",this.getDefault()),a(e,"elements",this.getNamedElements().map(t=>t.serialize())),e}};var ir=g(f(),1),Je=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Function}getText(){return this._context.getTypeChecker().typeToString(this._type)}getTypeParameters(){return this._node.typeParameters?.map(e=>new I(e,this._context))??[]}getParameters(){return(this._node.parameters??[]).map(e=>{let t=this._context.getSymbol(e),i=t?.getDeclarations()?.find(n=>ir.default.isParameter(n));return new X(i??e,t,this._context)})}getReturnType(){return u(this._node.type,this._context)}serialize(){let e={text:this.getText(),kind:this.getKind(),return:this.getReturnType().serialize()};return a(e,"typeParameters",this.getTypeParameters().map(t=>t.serialize())),a(e,"parameters",this.getParameters().map(t=>t.serialize())),e}};var Ue=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Optional}getText(){return`${this.getElementType().getText()}?`}getElementType(){return u(this._node.type,this._context)}serialize(){return{text:this.getText(),kind:this.getKind(),elementType:this.getElementType().serialize()}}};var $;(function(r){r.public="public",r.private="private",r.protected="protected"})($||($={}));var T=g(f(),1);function qe(r){let e=T.default.getCombinedModifierFlags(r);return B(e,T.default.ModifierFlags.Private)||r.name&&T.default.isPrivateIdentifier(r.name)?$.private:B(e,T.default.ModifierFlags.Protected)?$.protected:$.public}function We(r,e){let t=e.getTypeChecker(),i=t.getTypeAtLocation(r).getSymbol(),o=(i&&t.getDeclaredTypeOfSymbol(i))?.getProperties()??[];return or(r,o,e)}function nr(r,e){let t=e.getTypeChecker(),i=t.getTypeAtLocation(r).getSymbol(),n=i&&t.getTypeOfSymbolAtLocation(i,r),o=(n&&t.getPropertiesOfType(n))??[];return or(r,o,e)}function or(r,e,t){let i=[],n=t.getTypeChecker(),o=t.getSystem();for(let s of e){let c=s.getDeclarations()?.[0],l=c?.getSourceFile()?.fileName??"",y=l?o.realpath(l):"",S=n.getTypeOfSymbolAtLocation(s,r);if(B(s.flags,T.default.SymbolFlags.ModuleMember)||B(s.flags,T.default.SymbolFlags.Prototype)||K(y))continue;let D=Vr(r,s,n);i.push({inherited:D,symbol:s,type:S,overrides:Jr(c)})}return i}function Vr(r,e,t){let n=t.getTypeAtLocation(r).getBaseTypes()?.[0];if(!n)return!1;let o=n.getSymbol()?.getDeclarations()?.slice()??[],s=o.flatMap(c=>T.default.isClassDeclaration(c)?c.members.filter(T.default.isConstructorDeclaration):[]);return o.push(...s),o.some(c=>e.getDeclarations()?.some(l=>l.parent===c))}function sr(r){return r?T.default.isMethodSignature(r)||T.default.isPropertySignature(r)||T.default.isPropertyDeclaration(r)||T.default.isMethodDeclaration(r):!1}function $e(r){return!r||!T.default.canHaveModifiers(r)||T.default.isVariableStatement(r)||T.default.isImportDeclaration(r)?!1:B(T.default.getCombinedModifierFlags(r),T.default.ModifierFlags.Readonly)}function Jr(r){return!r||!T.default.canHaveModifiers(r)||T.default.isVariableStatement(r)||T.default.isImportDeclaration(r)?!1:B(T.default.getCombinedModifierFlags(r),T.default.ModifierFlags.Override)}function Ne(r){return!!r&&B(r.flags,T.default.SymbolFlags.Optional)}function le(r){return!r||!T.default.canHaveModifiers(r)||T.default.isVariableStatement(r)||T.default.isImportDeclaration(r)?!1:B(T.default.getCombinedModifierFlags(r),T.default.ModifierFlags.Static)}function me(r){return!r||!T.default.canHaveModifiers(r)||T.default.isVariableStatement(r)||T.default.isImportDeclaration(r)?!1:B(T.default.getCombinedModifierFlags(r),T.default.ModifierFlags.Abstract)}function B(r,e){return(r&e)===e}var Y=g(f(),1);function ar(r){return r?.statements.find(Y.default.isReturnStatement)}function re(r){return r!=null&&Y.default.isArrowFunction(r)}function ie(r){return r!=null&&Y.default.isFunctionExpression(r)}function He(r){if(r==null)return!1;if(Y.default.isFunctionDeclaration(r))return!0;if(!Y.default.isVariableStatement(r))return!1;let e=r.declarationList.declarations[0];if(!e)return!1;let t=e.initializer;return!!t&&(Y.default.isArrowFunction(t)||Y.default.isFunctionExpression(t))}var H;(function(r){r.Property="Property",r.Method="Method",r.IndexSignature="IndexSignature"})(H||(H={}));var ue=g(f(),1),Z=class{constructor(e,t,i){this._node=e,this._nodeContext=t,this._context=i;let[n,o]=this._getAccessors();n?this._jsDoc=new k(n):o?this._jsDoc=new k(o):this._jsDoc=new k(this._node)}getName(){let[e,t]=this._getAccessors();return e?e.name.getText()??"":t?t.name.getText()??"":ue.default.isIdentifier(this._node.name)?this._node.name.escapedText??"":this._node.name.getText()??""}getKind(){return H.Property}getTSNode(){return this._node}getContext(){return this._context}getLine(){let[e,t]=this._getAccessors();return e?this._context.getLinePosition(e):t?this._context.getLinePosition(t):this._context.getLocation(this._node).line}getType(){let e=ue.default.getJSDocType(this._node);return e?u(e,this._context):this._nodeContext?.type?u(this._nodeContext.type,this._context):this._node.type?u(this._node.type,this._context):ce(this._node,this._context)}getDefault(){let e=this.getJSDoc().getTag("default")?.text,[t,i]=this._getAccessors();if(e)return e;if(t)return O(ar(t.body)?.expression,this._context);if(!i)return O(this._node.initializer,this._context)}getModifier(){return ue.default.isClassElement(this._node)?qe(this._node):null}getJSDoc(){return this._jsDoc}getDecorators(){let[e,t]=this._getAccessors();return e?M(e).map(i=>new E(i,this._context)):t?M(t).map(i=>new E(i,this._context)):M(this._node).map(i=>new E(i,this._context))}isOptional(){if(this._nodeContext)return Ne(this._nodeContext.symbol);let e=this._context.getSymbol(this._node);return Ne(e)}isStatic(){let[e,t]=this._getAccessors();return e?le(e):t?le(t):le(this._node)}isReadOnly(){let e=!!this.getJSDoc().getTag("readonly"),[t,i]=this._getAccessors();return e||!!t&&!i||$e(this._node)}isWriteOnly(){let[e,t]=this._getAccessors();return!e&&!!t}isAbstract(){return me(this._node)}isInherited(){return!this._nodeContext?.overrides&&!!this._nodeContext?.inherited}overrides(){return!!this._nodeContext?.overrides}serialize(){let e={name:this.getName(),kind:this.getKind(),type:this.getType().serialize()};return a(e,"line",this.getLine()),a(e,"optional",this.isOptional()),a(e,"jsDoc",this.getJSDoc().serialize()),a(e,"decorators",this.getDecorators().map(t=>t.serialize())),a(e,"default",this.getDefault()),a(e,"static",this.isStatic()),a(e,"readOnly",this.isReadOnly()),a(e,"abstract",this.isAbstract()),a(e,"override",this.overrides()),a(e,"inherited",this.isInherited()),a(e,"writeOnly",this.isWriteOnly()),e}_getAccessors(){let e=this._nodeContext?.symbol?.getDeclarations()??[],t=e.find(ue.default.isGetAccessor),i=e.find(ue.default.isSetAccessor);return[t,i]}};var Kt=g(f(),1);function cr(r){return!!(r&&Kt.default.isModuleDeclaration(r)&&r.body&&Kt.default.isModuleBlock(r.body))}function Ur(r){let e=[r.name.getText()??""],t=r;for(;cr(t.parent?.parent);)e.push(t.parent?.parent?.name.getText()??""),t=t.parent?.parent;return e.reverse().join(".")}function j(r){let e=r.parent?.parent;for(;e&&!cr(e);)e=e.parent;return e?Ur(e):""}var lr=g(f(),1),ne=class{constructor(e,t){this._node=e,this._context=t,this._jsDoc=new k(this._node.getDeclaration())}getContext(){return this._context}getTSNode(){return this._node}getLine(){return this._context.getLinePosition(this._node.getDeclaration())}getPath(){let e=this._node.getDeclaration().getSourceFile().fileName??"";return e&&this._context.getSystem().realpath(e)}getJSDoc(){return this._jsDoc}getReturnType(){let e=lr.default.getJSDocReturnType(this._node.getDeclaration());if(e)return u(e,this._context);let t=this._context.getTypeChecker().getReturnTypeOfSignature(this._node);return u(t,this._context)}getTypeParameters(){return this._node.getDeclaration().typeParameters?.map(e=>new I(e,this._context))??[]}getParameters(){let e=this._node.parameters??[],t=this._node.getDeclaration().parameters??[],i=[];for(let n=0;n<t.length;n++){let o=t[n],s=new X(o,e[n]??null,this._context);s.getJSDoc().isIgnored()||i.push(s)}return i}getParameterByName(e){return this.getParameters().find(t=>t.getName()===e)??null}serialize(){let e={return:{type:this.getReturnType().serialize()}};return a(e,"line",this.getLine()),a(e,"jsDoc",this.getJSDoc().serialize()),a(e,"typeParameters",this.getTypeParameters().map(t=>t.serialize())),a(e,"parameters",this.getParameters().map(t=>t.serialize())),e}};var b=g(f(),1),U=class{constructor(e,t,i){this._jsDoc=null,this._node=e,this._member=t,this._context=i,(b.default.isVariableStatement(e)||b.default.isPropertyDeclaration(e)||b.default.isPropertySignature(e))&&(this._jsDoc=new k(e))}getName(){return b.default.isFunctionDeclaration(this._node)||b.default.isMethodDeclaration(this._node)||b.default.isMethodSignature(this._node)||b.default.isPropertyDeclaration(this._node)||b.default.isPropertySignature(this._node)?this._node.name?.getText()??"":b.default.isVariableStatement(this._node)?this._node.declarationList.declarations.find(t=>re(t.initializer)||ie(t.initializer))?.name.getText()??"":""}getNodeType(){return x.Declaration}getContext(){return this._context}getKind(){return sr(this._node)?H.Method:P.Function}getTSNode(){return this._node}getLine(){return this._context.getLocation(this._node).line}getNamespace(){return j(this._node)}getJSDoc(){return this._jsDoc}getDecorators(){return M(this._node).map(e=>new E(e,this._context))}getDecoratorWithName(e){return this.getDecorators().find(t=>t.getName()===e)??null}getSignatures(){let e=this._getFunctionNode(),t=this._context.getTypeChecker(),i=this._member?.type;if(!i){let n=e&&this._context.getSymbol(e);i=e&&n&&t.getTypeOfSymbolAtLocation(n,e.getSourceFile())}if(!i){let n=e&&t.getSignatureFromDeclaration(e);return n?[new ne(n,this._context)]:[]}return i.getNonNullableType().getCallSignatures().map(n=>new ne(n,this._context))}getModifier(){return b.default.isClassElement(this._node)?qe(this._node):null}isGenerator(){let e=this._getFunctionNode();return!!e&&!b.default.isMethodSignature(e)&&!b.default.isFunctionTypeNode(e)&&!!e.asteriskToken}isAsync(){let e=this._getFunctionNode();return e?xe(e).some(t=>t.kind===b.default.SyntaxKind.AsyncKeyword):!1}isOptional(){return Ne(this._member?.symbol)}isStatic(){return le(this._node)}isReadOnly(){return $e(this._node)}isAbstract(){return me(this._node)}isInherited(){return!this._member?.overrides&&!!this._member?.inherited}isArrowFunctionOrFunctionExpression(){return b.default.isVariableStatement(this._node)?this._node.declarationList.declarations.some(e=>re(e.initializer)||ie(e.initializer)):!1}overrides(){return!!this._member?.overrides}serialize(){let e={name:this.getName(),kind:this.getKind(),signatures:this.getSignatures().map(t=>t.serialize())};return a(e,"namespace",this.getNamespace()),a(e,"jsDoc",this.getJSDoc()?.serialize()),a(e,"decorators",this.getDecorators().map(t=>t.serialize())),a(e,"async",this.isAsync()),a(e,"generator",this.isGenerator()),a(e,"static",this.isStatic()),a(e,"readOnly",this.isReadOnly()),a(e,"abstract",this.isAbstract()),a(e,"override",this.overrides()),a(e,"inherited",this.isInherited()),a(e,"optional",this.isOptional()),e}_getFunctionNode(){let e=this._node;return b.default.isVariableStatement(this._node)&&(e=this._node.declarationList.declarations.find(i=>re(i.initializer)||ie(i.initializer))?.initializer),b.default.isPropertySignature(this._node)&&(e=this._node.type&&b.default.isFunctionTypeNode(this._node.type)?this._node.type:null),b.default.isPropertyDeclaration(this._node)&&(e=this._node.initializer),e==null||!b.default.isFunctionDeclaration(e)&&!b.default.isArrowFunction(e)&&!b.default.isFunctionExpression(e)&&!b.default.isMethodSignature(e)&&!b.default.isMethodDeclaration(e)&&!b.default.isFunctionTypeNode(e)?null:e}};var Et=g(f(),1),Qe=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getKind(){return m.ObjectLiteral}getProperties(){let e=this._context.getTypeChecker(),t=this._node.members??[],i=[];for(let n of t){if(!Et.default.isPropertySignature(n))continue;let o=this._context.getSymbol(n),s=o&&e.getTypeOfSymbolAtLocation(o,this._node);i.push(new Z(n,{symbol:o,type:s},this._context))}return i}getMethods(){let e=this._context.getTypeChecker(),t=this._node.members??[],i=[];for(let n of t){if(!Et.default.isMethodSignature(n))continue;let o=this._context.getSymbol(n),s=o&&e.getTypeOfSymbolAtLocation(o,this._node);i.push(new U(n,{symbol:o,type:s},this._context))}return i}serialize(){let e={text:this.getText(),kind:this.getKind()};return a(e,"properties",this.getProperties().map(t=>t.serialize())),a(e,"methods",this.getMethods().map(t=>t.serialize())),e}};var pe=g(f(),1),de=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Unknown}getText(){let e={[pe.default.SyntaxKind.AnyKeyword]:"any",[pe.default.SyntaxKind.NeverKeyword]:"never",[pe.default.SyntaxKind.ObjectKeyword]:"object",[pe.default.SyntaxKind.UnknownKeyword]:"unknown",[pe.default.SyntaxKind.IntrinsicKeyword]:"intrinsic"},t=this._node&&e[this._node.kind];return t||this._context.getTypeChecker().typeToString(this._type)}serialize(){return{text:this.getText(),kind:this.getKind()}}};var v=g(f(),1),Ge=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Literal}getText(){switch(this._node.literal.kind){case v.default.SyntaxKind.TrueKeyword:return"true";case v.default.SyntaxKind.FalseKeyword:return"false";case v.default.SyntaxKind.NullKeyword:return"null";case v.default.SyntaxKind.PrefixUnaryExpression:{let t=this._node.literal.operand;return this._getUnaryExpressionText(t)}case v.default.SyntaxKind.NumericLiteral:return this._node.literal.text;case v.default.SyntaxKind.StringLiteral:return`"${this._node.literal.text}"`;case v.default.SyntaxKind.BigIntLiteral:return this._node.literal.text;case v.default.SyntaxKind.NoSubstitutionTemplateLiteral:return this._node.literal.text;default:return""}}serialize(){return{text:this.getText(),kind:this.getKind()}}_getUnaryExpressionText(e){switch(e.kind){case v.default.SyntaxKind.NumericLiteral:return this._node.literal.getText();case v.default.SyntaxKind.BigIntLiteral:return this._node.literal.getText().replace("n","");default:return""}}};var Xe=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Mapped}getText(){return this._context.getTypeChecker().typeToString(this._type)}serialize(){return{text:this.getText(),kind:this.getKind()}}};var Ye=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i,this._loc=i.getLocation(e.exprName)}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Query}getPath(){return this._loc.path}getLine(){return this._loc.line}getText(){return this._context.getTypeChecker().typeToString(this._type)}getTypeArguments(){return(this._node.typeArguments??[]).map(e=>u(e,this._context))}serialize(){let e={text:this.getText(),kind:this.getKind()},t={},i=this.getPath(),n=this.getLine();return!K(i)&&n!=null&&(t.line=n,t.path=i),a(e,"source",t),a(e,"typeArguments",this.getTypeArguments().map(o=>o.serialize())),e}};var Ze=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Infer}getText(){let e=this.getConstraint(),t=this._node.typeParameter.name.text;return e?`infer ${t} extends ${e.getText()}`:`infer ${t}`}getConstraint(){let e=this._node.typeParameter.constraint;return e?u(e,this._context):null}serialize(){let e={text:this.getText(),kind:this.getKind()};return a(e,"constraint",this.getConstraint()?.serialize()),e}};var et=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Union}getText(){try{return this._node.getText()??""}catch{return this._context.getTypeChecker().typeToString(this._type)??""}}getElements(){return this._node.types.map(e=>u(e,this._context))}serialize(){return{text:this.getText(),kind:this.getKind(),elements:this.getElements().map(e=>e.serialize())}}};var tt=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Array}getText(){return`${this.getElementType().getText()}[]`}getElementType(){return u(this._node.elementType,this._context)}serialize(){return{text:this.getText(),kind:this.getKind(),elementType:this.getElementType().serialize()}}};var rt=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Tuple}getText(){return`[${this.getElements().map(e=>e.getText()).join(", ")}]`}getElements(){return this._node.elements.map(e=>u(e,this._context))}serialize(){return{text:this.getText(),kind:this.getKind(),elements:this.getElements().map(e=>e.serialize())}}};var it=class{constructor(e,t,i){this._node=e,this._type=t,this._context=i}getContext(){return this._context}getTSNode(){return this._node}getTSType(){return this._type}getKind(){return m.Rest}getText(){return`...${this.getElementType().getText()}`}getElementType(){return u(this._node.type,this._context)}serialize(){return{text:this.getText(),kind:this.getKind(),elementType:this.getElementType().serialize()}}};var _=g(f(),1),qr={[_.default.SyntaxKind.TypeLiteral]:(r,e,t)=>new Qe(r,e,t),[_.default.SyntaxKind.ConditionalType]:(r,e,t)=>new Ie(r,e,t),[_.default.SyntaxKind.UnionType]:(r,e,t)=>new et(r,e,t),[_.default.SyntaxKind.IntersectionType]:(r,e,t)=>new Me(r,e,t),[_.default.SyntaxKind.ArrayType]:(r,e,t)=>new tt(r,e,t),[_.default.SyntaxKind.TypeReference]:(r,e,t)=>new je(r,e,t),[_.default.SyntaxKind.TupleType]:(r,e,t)=>new rt(r,e,t),[_.default.SyntaxKind.NamedTupleMember]:(r,e,t)=>new Fe(r,e,t),[_.default.SyntaxKind.TypeOperator]:(r,e,t)=>new Be(r,e,t),[_.default.SyntaxKind.LiteralType]:(r,e,t)=>new Ge(r,e,t),[_.default.SyntaxKind.IndexedAccessType]:(r,e,t)=>new Oe(r,e,t),[_.default.SyntaxKind.FunctionType]:(r,e,t)=>new Je(r,e,t),[_.default.SyntaxKind.TypeQuery]:(r,e,t)=>new Ye(r,e,t),[_.default.SyntaxKind.InferType]:(r,e,t)=>new Ze(r,e,t),[_.default.SyntaxKind.MappedType]:(r,e,t)=>new Xe(r,e,t),[_.default.SyntaxKind.OptionalType]:(r,e,t)=>new Ue(r,e,t),[_.default.SyntaxKind.TypePredicate]:(r,e,t)=>new Re(r,e,t),[_.default.SyntaxKind.RestType]:(r,e,t)=>new it(r,e,t),[_.default.SyntaxKind.TemplateLiteralType]:(r,e,t)=>new Le(r,e,t),[_.default.SyntaxKind.AnyKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.BigIntKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.BooleanKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.NeverKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.NumberKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.ObjectKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.StringKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.SymbolKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.UndefinedKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.VoidKeyword]:(r,e,t)=>new L(r,e,t),[_.default.SyntaxKind.UnknownKeyword]:(r,e,t)=>new de(r,e,t)};function u(r,e){let t=e.getTypeChecker(),i,n;if("kind"in r)i=r,n=t.getTypeFromTypeNode(r);else if(i=t.typeToTypeNode(r,void 0,_.default.NodeBuilderFlags.IgnoreErrors)??null,n=r,!i)return new de(null,r,e);_.default.isParenthesizedTypeNode(i)&&(i=i.type,n=t.getTypeFromTypeNode(i));let o=qr[i.kind];return o?o(i,n,e):new de(i,n,e)}function ce(r,e){let t=e.getTypeChecker(),i=_.default.getJSDocType(r);if(i)return u(i,e);let n=t.getTypeAtLocation(r);return Wr(r)||(n=t.getBaseTypeOfLiteralType(n)),u(n,e)}function Wr(r){return _.default.hasOnlyExpressionInitializer(r)&&!!r.initializer&&(_.default.isAsExpression(r.initializer)||_.default.isTypeAssertionExpression(r))}var I=class{constructor(e,t){this._node=e,this._context=t}getContext(){return this._context}getName(){return this._node.name.getText()??""}getTSNode(){return this._node}getLine(){return this._context.getLinePosition(this._node)}getDefault(){return this._node.default?u(this._node.default,this._context):null}getConstraint(){return this._node.constraint?u(this._node.constraint,this._context):null}hasDefault(){return!!this._node.default}serialize(){let e={name:this.getName()};return a(e,"default",this.getDefault()?.serialize()),a(e,"constraint",this.getConstraint()?.serialize()),e}};var nt=class{constructor(e,t){this._node=e,this._context=t,this._jsDoc=new k(this._node)}getContext(){return this._context}getTSNode(){return this._node}getNodeType(){return x.Declaration}getKind(){return P.TypeAlias}getName(){return this._node.name.getText()??""}getLine(){return this._context.getLinePosition(this._node)}getNamespace(){return j(this._node)}getJSDoc(){return this._jsDoc}getValue(){return u(this._node.type,this._context)}getTypeParameters(){return this._node.typeParameters?.map(e=>new I(e,this._context))??[]}serialize(){let e={name:this.getName(),kind:this.getKind(),line:this.getLine(),value:this.getValue().serialize()};return a(e,"namespace",this.getNamespace()),a(e,"jsDoc",this.getJSDoc().serialize()),a(e,"typeParameters",this.getTypeParameters().map(t=>t.serialize())),e}};var mr=g(f(),1),ur={isNode:r=>mr.default.isTypeAliasDeclaration(r),create:(r,e)=>[e.registerReflectedNode(r,()=>new nt(r,e))]};var pr=g(f(),1),he=class{constructor(e,t){this._node=e,this._context=t,this._loc=t.getLocation(e.expression)}getContext(){return this._context}getTSNode(){return this._node}getName(){return this._node.expression.getText()}getTypeArguments(){return(this._node.typeArguments??[]).map(e=>u(e,this._context))}getPath(){return this._loc.path}getLine(){return this._loc.line}serialize(){let e={name:this.getName(),kind:this._loc.symbol&&B(this._loc.symbol.flags,pr.default.SymbolFlags.Class)?P.Class:P.Interface},t={},i=this.getPath(),n=this.getLine();return!K(i)&&n!=null&&(t.line=n,t.path=i),a(e,"source",t),a(e,"typeArguments",this.getTypeArguments().map(o=>o.serialize())),e}};var ot=class{constructor(e,t,i){this._node=e,this._member=t,this._context=i,this._parameter=this._getParameter(),this._jsDoc=new k(this._node)}getName(){return this._parameter?.getName()??""}getContext(){return this._context}getKind(){return H.IndexSignature}getTSNode(){return this._node}getJSDoc(){return this._jsDoc}getLine(){return this._context.getLinePosition(this._node)}getType(){return u(this._node.type,this._context)}getIndexType(){return this._parameter?.getType()??null}isOptional(){return!!this._parameter?.isOptional()}serialize(){let e={name:this.getName(),line:this.getLine(),kind:H.IndexSignature,type:this.getType().serialize()};return a(e,"indexType",this.getIndexType()?.serialize()),a(e,"optional",this.isOptional()),a(e,"jsDoc",this.getJSDoc().serialize()),e}_getParameter(){let e=this._member.type?.getCallSignatures()?.[0],t=this._node.parameters??[],i=e?.parameters??[],n=t[0],o=i[0]??null;return n?new X(n,o,this._context):null}};var q=g(f(),1),st=class{constructor(e,t){this._members=[],this._heritage=[],this._node=e,this._context=t,this._members=We(this._node,this._context),this._jsDoc=new k(this._node),this._heritage=(this._node.heritageClauses??[]).flatMap(i=>i.types.map(n=>new he(n,this._context)))}getName(){return this._node.name.getText()??""}getNodeType(){return x.Declaration}getKind(){return P.Interface}getContext(){return this._context}getTSNode(){return this._node}getLine(){return this._context.getLinePosition(this._node)}getIndexSignature(){let e=this._context.getTypeChecker(),t=this._context.getSymbol(this._node)?.members?.get("__index"),i=t?.getDeclarations()?.[0];if(!i||!q.default.isIndexSignatureDeclaration(i))return null;let n={symbol:t,type:e.getTypeOfSymbolAtLocation(t,this._node)},o=()=>new ot(i,n,this._context);return this._context.registerReflectedNode(i,o)}getProperties(){let e=[];for(let t of this._members){let{symbol:i}=t,n=i?.getDeclarations()?.[0];if(!n)continue;let o=q.default.isPropertySignature(n)&&n.type&&q.default.isFunctionTypeNode(n.type);if((q.default.isPropertySignature(n)||q.default.isGetAccessor(n)||q.default.isSetAccessor(n))&&!o){let s=new Z(n,t,this._context);e.push(s)}}return e}getPropertyWithName(e){return this.getProperties().find(t=>t.getName()===e)??null}getMethods(){let e=[];for(let t of this._members){let{symbol:i}=t,n=i?.getDeclarations()?.[0];if(!n)continue;let o=q.default.isPropertySignature(n)&&n.type&&q.default.isFunctionTypeNode(n.type);if(q.default.isMethodSignature(n)||o){let s=new U(n,t,this._context);e.push(s)}}return e}getMethodWithName(e){return this.getMethods().find(t=>t.getName()===e)??null}getTypeParameters(){return(this._node.typeParameters??[]).map(e=>new I(e,this._context))}getNamespace(){return j(this._node)}getJSDoc(){return this._jsDoc}getHeritage(){return this._heritage}serialize(){let e={name:this.getName(),kind:this.getKind(),line:this.getLine()};return a(e,"heritage",this.getHeritage().map(t=>t.serialize())),a(e,"typeParameters",this.getTypeParameters().map(t=>t.serialize())),a(e,"jsDoc",this.getJSDoc().serialize()),a(e,"namespace",this.getNamespace()),a(e,"indexSignature",this.getIndexSignature()?.serialize()),a(e,"properties",this.getProperties().map(t=>t.serialize())),a(e,"methods",this.getMethods().map(t=>t.serialize())),e}};var dr=g(f(),1),hr={isNode:r=>dr.default.isInterfaceDeclaration(r),create:(r,e)=>[e.registerReflectedNode(r,()=>new st(r,e))]};var gr={isNode:He,create:(r,e)=>[e.registerReflectedNode(r,()=>new U(r,null,e))]};var at=class{constructor(e,t,i){this._node=e,this._declaration=t,this._context=i,this._jsDoc=new k(this._node)}getContext(){return this._context}getName(){return this._declaration.name.getText()??""}getTSNode(){return this._declaration}getNodeType(){return x.Declaration}getKind(){return P.Variable}getDecorators(){return M(this._node).map(e=>new E(e,this._context))}getLine(){return this._context.getLinePosition(this._node)}getType(){return ce(this._declaration,this._context)}getValue(){return this.getJSDoc().getTag("default")?.text??O(this._declaration.initializer,this._context)}getNamespace(){return j(this._node)}getJSDoc(){return this._jsDoc}serialize(){let e=this.getValue(),t={name:this.getName(),kind:this.getKind(),line:this.getLine(),type:this.getType().serialize()};return e!==""&&(t.default=e),a(t,"jsDoc",this.getJSDoc().serialize()),a(t,"decorators",this.getDecorators().map(i=>i.serialize())),a(t,"namespace",this.getNamespace()),t}};var ct=g(f(),1);function lt(r){if(ct.default.isClassDeclaration(r))return!0;if(!ct.default.isVariableStatement(r))return!1;let e=r.declarationList.declarations[0];if(!e)return!1;let t=e.initializer;return!!t&&ct.default.isClassExpression(t)}var fr=g(f(),1),yr={isNode:r=>fr.default.isVariableStatement(r)&&!He(r)&&!lt(r),create:(r,e)=>{let t=[];for(let i of r.declarationList.declarations){let n=()=>new at(r,i,e),o=e.registerReflectedNode(i,n);t.push(o)}return t}};var z;(function(r){r.Default="Default",r.Named="Named",r.Namespace="Namespace",r.SideEffect="SideEffect",r.Dynamic="Dynamic"})(z||(z={}));var mt=class{constructor(e,t){this._node=e,this._context=t}getTSNode(){return this._node}getNodeType(){return x.Import}getKind(){return z.SideEffect}getContext(){return this._context}getImportPath(){return this._node.moduleSpecifier.text??""}isBareModuleSpecifier(){return Q(this.getImportPath())}serialize(){let e={kind:z.SideEffect,importPath:this.getImportPath()};return a(e,"bareModuleSpecifier",this.isBareModuleSpecifier()),e}};var ut=class{constructor(e,t){this._node=e,this._context=t}getTSNode(){return this._node}getContext(){return this._context}getName(){return(this._node.importClause?.namedBindings).name.escapedText??""}getNodeType(){return x.Import}getKind(){return z.Namespace}getImportPath(){return this._node.moduleSpecifier.text??""}getOriginalPath(){let e=(this._node.importClause?.namedBindings).name,t=this.getImportPath(),i=this._context.getCommandLine().options;return ae(t,i)?se(e,this._context):t}isTypeOnly(){return!!this._node.importClause?.isTypeOnly}isBareModuleSpecifier(){return Q(this.getImportPath())}serialize(){let e=this.getOriginalPath(),t={name:this.getName(),kind:this.getKind(),importPath:this.getImportPath()};return e!==t.importPath&&(t.originalPath=e),a(t,"typeOnly",this.isTypeOnly()),a(t,"bareModuleSpecifier",this.isBareModuleSpecifier()),t}};var pt=class{constructor(e,t){this._node=e,this._context=t}getName(){return this._node.importClause?.name?.escapedText??""}getTSNode(){return this._node}getContext(){return this._context}getNodeType(){return x.Import}getKind(){return z.Default}getReferenceName(){return this.getName()}getImportPath(){return this._node.moduleSpecifier.text??""}getOriginalPath(){let e=this._node.importClause?.name,t=this.getImportPath(),i=this._context.getCommandLine().options;return ae(t,i)?se(e,this._context):t}isTypeOnly(){return!!this._node.importClause?.isTypeOnly}isBareModuleSpecifier(){return Q(this.getImportPath())}serialize(){let e=this.getOriginalPath(),t={name:this.getName(),kind:this.getKind(),importPath:this.getImportPath()};return e!==t.importPath&&(t.originalPath=e),a(t,"typeOnly",this.isTypeOnly()),a(t,"bareModuleSpecifier",this.isBareModuleSpecifier()),t}};var dt=class{constructor(e,t,i){this._node=e,this._element=t,this._context=i}getTSNode(){return this._node}getContext(){return this._context}getName(){return this._element.name.escapedText??""}getReferenceName(){return this._element.propertyName?.escapedText??this.getName()}getNodeType(){return x.Import}getKind(){return z.Named}getImportPath(){return this._node.moduleSpecifier.text??""}getOriginalPath(){let e=this.getImportPath(),t=this._context.getCommandLine().options;return ae(e,t)?se(this._element.name,this._context):e}isTypeOnly(){return!!this._node.importClause?.isTypeOnly||this._element.isTypeOnly}isBareModuleSpecifier(){return Q(this.getImportPath())}serialize(){let e=this.getOriginalPath(),t=this.getReferenceName(),i={name:this.getName(),kind:this.getKind(),importPath:this.getImportPath()};return t!==i.name&&(i.referenceName=t),e!==i.importPath&&(i.originalPath=e),a(i,"typeOnly",this.isTypeOnly()),a(i,"bareModuleSpecifier",this.isBareModuleSpecifier()),i}};var _r=g(f(),1),ht={isNode:r=>_r.default.isImportDeclaration(r),create:(r,e)=>{let t=[];return Ut(r)&&t.push(new pt(r,e)),Wt(r)&&t.push(new mt(r,e)),bt(r)&&((r.importClause?.namedBindings).elements??[]).forEach(n=>t.push(new dt(r,n,e))),qt(r)&&t.push(new ut(r,e)),t}};function xr(r,e){let t=e.getTypeChecker(),i=t.getTypeAtLocation(r),n=i.isClassOrInterface()?t.getBaseTypes(i):[];for(let o of n)if(Tr(o,t))return!0;return!1}function Tr(r,e){return r.getSymbol()?.getName()==="HTMLElement"?!0:r.isClassOrInterface()?e.getBaseTypes(r).some(i=>Tr(i,e)):!1}var V=g(f(),1),gt=class{constructor(e,t){this._instanceMembers=[],this._staticMembers=[],this._heritage=[],this._node=e,this._context=t,this._jsDoc=new k(e);let i=this._getClassNode();i&&(this._instanceMembers=We(i,this._context),this._staticMembers=nr(i,this._context),this._heritage=(i.heritageClauses??[]).flatMap(n=>n.types.map(o=>new he(o,this._context))))}getName(){return V.default.isVariableStatement(this._node)?this._node.declarationList.declarations[0]?.name.getText()??"":this._node.name?.getText()??""}getNodeType(){return x.Declaration}getKind(){return P.Class}getContext(){return this._context}getTSNode(){return this._node}getLine(){return this._context.getLinePosition(this._node)}getNamespace(){return j(this._node)}getJSDoc(){return this._jsDoc}getDecorators(){return M(this._node).map(e=>new E(e,this._context))}getDecoratorWithName(e){return this.getDecorators().find(t=>t.getName()===e)??null}getConstructors(){let e=this._getClassNode();if(!e)return[];let t=this._context.getTypeChecker(),i=t.getTypeAtLocation(e).getSymbol(),o=(i&&t.getTypeOfSymbolAtLocation(i,e))?.getConstructSignatures()??[],s=[];for(let c of o){if(!c.getDeclaration())continue;let l=new ne(c,this._context),y=l.getPath();y&&!K(y)&&s.push(l)}return s}getProperties(){return this._getPropertyMembers(this._instanceMembers)}getStaticProperties(){return this._getPropertyMembers(this._staticMembers)}getPropertyWithName(e){return this.getProperties().find(t=>t.getName()===e)??null}getMethods(){return this._getMethodMembers(this._instanceMembers)}getStaticMethods(){return this._getMethodMembers(this._staticMembers)}getMethodWithName(e){return this.getMethods().find(t=>t.getName()===e)??null}getTypeParameters(){let e=this._getClassNode();return e?e.typeParameters?.map(t=>new I(t,this._context))??[]:[]}getHeritage(){return this._heritage}isCustomElement(){let e=this._getClassNode();return e?xr(e,this._context):!1}isAbstract(){let e=this._getClassNode();return e?me(e):!1}serialize(){let e={name:this.getName(),kind:this.getKind(),line:this.getLine()};return a(e,"constructors",this.getConstructors().map(t=>t.serialize())),a(e,"decorators",this.getDecorators().map(t=>t.serialize())),a(e,"jsDoc",this.getJSDoc().serialize()),a(e,"typeParameters",this.getTypeParameters().map(t=>t.serialize())),a(e,"heritage",this.getHeritage().map(t=>t.serialize())),a(e,"abstract",this.isAbstract()),a(e,"customElement",this.isCustomElement()),a(e,"namespace",this.getNamespace()),a(e,"properties",this.getProperties().map(t=>t.serialize())),a(e,"staticProperties",this.getStaticProperties().map(t=>t.serialize())),a(e,"methods",this.getMethods().map(t=>t.serialize())),a(e,"staticMethods",this.getStaticMethods().map(t=>t.serialize())),e}_getPropertyMembers(e){let t=[];for(let i of e){let{symbol:n}=i,o=n?.getDeclarations()?.[0];if(!o)continue;let s=V.default.isPropertyDeclaration(o);if(!(V.default.isMethodDeclaration(o)||s&&(re(o.initializer)||ie(o.initializer)))&&(s||V.default.isGetAccessor(o)||V.default.isSetAccessor(o))){let l=new Z(o,i,this._context);l.getModifier()===$.public&&t.push(l)}}return t}_getMethodMembers(e){let t=[];for(let i of e){let{symbol:n}=i,o=n?.getDeclarations()?.[0];if(!o)continue;let s=V.default.isPropertyDeclaration(o);if(V.default.isMethodDeclaration(o)||s&&(re(o.initializer)||ie(o.initializer))){let l=new U(o,i,this._context);l.getModifier()===$.public&&t.push(l)}}return t}_getClassNode(){if(V.default.isClassDeclaration(this._node)||V.default.isClassExpression(this._node))return this._node;let t=this._node.declarationList.declarations[0]?.initializer;return!t||!V.default.isClassExpression(t)?null:t}};var Sr={isNode:r=>lt(r),create:(r,e)=>[e.registerReflectedNode(r,()=>new gt(r,e))]};var ft=class{constructor(e,t,i){this._node=e,this._value=t,this._context=i,this._jsDoc=new k(e)}getName(){return this._node.name.getText()??""}getValue(){return this._value}getContext(){return this._context}getLine(){return this._context.getLinePosition(this._node)}getTSNode(){return this._node}getJSDoc(){return this._jsDoc}serialize(){let e={name:this.getName(),value:this.getValue()};return a(e,"jsDoc",this.getJSDoc().serialize()),e}};var yt=class{constructor(e,t){this._node=e,this._context=t,this._jsDoc=new k(this._node)}getNodeType(){return x.Declaration}getKind(){return P.Enum}getTSNode(){return this._node}getContext(){return this._context}getName(){return this._node.name.getText()??""}getLine(){return this._context.getLinePosition(this._node)}getNamespace(){return j(this._node)}getJSDoc(){return this._jsDoc}getMembers(){let e=0;return this._node.members.map(t=>{let i=t.initializer?.getText()??"";if(i!==""){let o=parseInt(i);isNaN(o)||(e=o+1,i=o)}else i=e++;let n=()=>new ft(t,i,this._context);return this._context.registerReflectedNode(t,n)})}serialize(){let e={kind:this.getKind(),name:this.getName(),line:this.getLine()};return a(e,"namespace",this.getNamespace()),a(e,"members",this.getMembers().map(t=>t.serialize())),a(e,"jsDoc",this.getJSDoc().serialize()),e}};var kr=g(f(),1),Nr={isNode:r=>kr.default.isEnumDeclaration(r),create:(r,e)=>[e.registerReflectedNode(r,()=>new yt(r,e))]};var br=[gr,Sr,yr,Nr,ur,hr],Pr=[Bt,vt,Vt];var h={ImportNode:r=>r==null||typeof r!="object"?!1:"getNodeType"in r&&typeof r.getNodeType=="function"&&r.getNodeType()===x.Import,DefaultImportNode:r=>h.ImportNode(r)&&r.getKind()===z.Default,NamedImportNode:r=>h.ImportNode(r)&&r.getKind()===z.Named,NamespaceImportNode:r=>h.ImportNode(r)&&r.getKind()===z.Namespace,SideEffectImportNode:r=>h.ImportNode(r)&&r.getKind()===z.SideEffect,DeclarationNode:r=>r==null||typeof r!="object"?!1:"getNodeType"in r&&typeof r.getNodeType=="function"&&r.getNodeType()===x.Declaration,EnumNode:r=>h.DeclarationNode(r)&&r.getKind()===P.Enum,VariableNode:r=>h.DeclarationNode(r)&&r.getKind()===P.Variable,TypeAliasNode:r=>h.DeclarationNode(r)&&r.getKind()===P.TypeAlias,FunctionNode:r=>h.DeclarationNode(r)&&r.getKind()===P.Function,ClassNode:r=>h.DeclarationNode(r)&&r.getKind()===P.Class,InterfaceNode:r=>h.DeclarationNode(r)&&r.getKind()===P.Interface,TypeNode:r=>r==null||typeof r!="object"?!1:"getKind"in r&&typeof r.getKind=="function",ArrayTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Array,ConditionalTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Conditional,FunctionTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Function,IndexedAccessTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.IndexAccess,InferTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Infer,IntersectionTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Intersection,LiteralTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.ObjectLiteral,MappedTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Mapped,NamedTupleMemberNode:r=>h.TypeNode(r)&&r.getKind()===m.NamedTupleMember,OptionalTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Optional,PrimitiveTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Intrinsic,RestTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Rest,TemplateLiteralTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.TemplateLiteral,TupleTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Tuple,TypeLiteralNode:r=>h.TypeNode(r)&&r.getKind()===m.Literal,TypeOperatorNode:r=>h.TypeNode(r)&&r.getKind()===m.Operator,TypePredicateNode:r=>h.TypeNode(r)&&r.getKind()===m.Predicate,TypeQueryNode:r=>h.TypeNode(r)&&r.getKind()===m.Query,TypeReferenceNode:r=>h.TypeNode(r)&&r.getKind()===m.Reference,UnionTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Union,UnknownTypeNode:r=>h.TypeNode(r)&&r.getKind()===m.Unknown,ExportNode:r=>r==null||typeof r!="object"?!1:"getNodeType"in r&&typeof r.getNodeType=="function"&&r.getNodeType()===x.Export,DefaultExportNode:r=>h.ExportNode(r)&&r.getKind()===w.Default,NamedExportNode:r=>h.ExportNode(r)&&r.getKind()===w.Named,EqualExportNode:r=>h.ExportNode(r)&&r.getKind()===w.Equals,NamespaceExportNode:r=>h.ExportNode(r)&&r.getKind()===w.Namespace,ReExportNode:r=>h.ExportNode(r)&&r.getKind()===w.Star};var Lt=g(f(),1),ge=class{constructor(e,t){this._declarations=[],this._exports=[],this._imports=[],this._node=e,this._context=t,this._jsDoc=new k(this._node),this._visitNode(e),this._removeNonPublicDeclarations()}getTSNode(){return this._node}getSourcePath(){return this._context.getSystem().normalizePath(this._node.fileName)}getOutputPath(){let e=this._node.fileName,t=this._context.getSystem();if(e.endsWith("js"))return t.normalizePath(e);let i=t.getAbsolutePath(e),n=Lt.default.getOutputFileNames(this._context.getCommandLine(),i,!1)[0];return t.normalizePath(n??"")}getContext(){return this._context}getImports(){return this._imports}getExports(){return this._exports}getDeclarations(){return this._declarations}getJSDoc(){return this._jsDoc}getDeclarationByKind(e){return this.getDeclarations().filter(t=>t.getKind()===e)}getDeclarationByName(e){return this.getDeclarations().find(t=>t.getName()===e)??null}getDeclarationsByCategory(e){return this.getDeclarations().filter(t=>t.getJSDoc()?.getTag("category")?.text===e)}serialize(){let e={sourcePath:this.getSourcePath(),outputPath:this.getOutputPath(),imports:this.getImports().map(t=>t.serialize()),declarations:this.getDeclarations().map(t=>t.serialize()),exports:this.getExports().map(t=>t.serialize())};return a(e,"jsDoc",this.getJSDoc().serialize()),e}_visitNode(e){let t=!1;ht.isNode(e)&&this._add(ht.create(e,this._context));for(let i of br)i.isNode(e)&&(this._add(i.create(e,this._context)),t=!0);for(let i of Pr)i.isNode(e)&&this._add(i.create(e,this._context));t||Lt.default.forEachChild(e,i=>this._visitNode(i))}_add(e){for(let t of e)h.ImportNode(t)&&this._imports.push(t),h.DeclarationNode(t)&&!this._hasDeclaration(t)&&this._declarations.push(t),h.ExportNode(t)&&!this._hasExport(t)&&this._exports.push(t)}_hasDeclaration(e){return this._declarations.some(t=>t.getName()===e.getName())}_hasExport(e){return h.ReExportNode(e)?this._exports.some(t=>h.ReExportNode(t)&&t.getModule()===e.getModule()):this._exports.some(t=>t.getName()===e.getName()&&t.getKind()===e.getKind())}_removeNonPublicDeclarations(){this._declarations=this._declarations.filter(e=>{let t=this._exports.findIndex(n=>n.getOriginalName()===e.getName()),i=!!e.getJSDoc()?.isIgnored();return t===-1?!1:(i&&this._exports.splice(t,1),!i)})}};var fe=g(f(),1),_t=class r{constructor(e,t,i,n,o={}){this._fileNames=new Set,this._modules=[],this._options={},this._system=e,this._compilerHost=t,this._program=i,this._commandLine=n,this._options=o,this._diagnostics=new be(e.getCurrentDirectory()),this._packageJson=this._getPackageJSON(),this._context=new De(e,()=>this._program,()=>this._commandLine,this._diagnostics,o);let s=fe.default.getConfigFileParsingDiagnostics(n);this._diagnostics.addManyDiagnostics(s),this._diagnostics.addManyDiagnostics(i.getSyntacticDiagnostics()),this._diagnostics.addManyDiagnostics(i.getSemanticDiagnostics());for(let c of i.getRootFileNames()){let l=i.getSourceFile(c);if(!l){this._diagnostics.addArgumentError(`Unable to analyse file "${c}".`);continue}this._fileNames.add(c),this._modules.push(new ge(l,this._context))}}static fromTSConfig(e,t={}){let i=ye(e,t),n=new oe(e,i.options),o=fe.default.createProgram({rootNames:i.fileNames,options:i.options,host:n,projectReferences:i.projectReferences??[]});return new r(e,n,o,i,t)}static fromFiles(e,t,i={}){let n=ye(e,i),o=new oe(e,n.options),s=fe.default.createProgram({rootNames:t.map(c=>e.getAbsolutePath(c)),options:n.options,host:o,projectReferences:n.projectReferences??[]});return new r(e,o,s,n,i)}static fromSource(e,t,i={}){let n="unknown.ts";e.writeFile(n,t);let o=ye(e,i),s=new oe(e,o.options),c=fe.default.createProgram({rootNames:[e.getAbsolutePath(n)],options:o.options,host:s,projectReferences:o.projectReferences??[]});return new r(e,s,c,o,i)}getSystem(){return this._system}getProgram(){return this._program}getTypeChecker(){return this._program.getTypeChecker()}getOptions(){return this._options}getDiagnostics(){return this._diagnostics}getModules(){return this._modules}has(e){let t=this._context.getSystem().normalizePath(e);return this._modules.some(i=>i.getSourcePath()===t)}add(e,t){let i=this._system.normalizePath(e),n=this._system.getAbsolutePath(e);if(this._modules.find(l=>l.getSourcePath()===i))throw new Error("File already exist");let s=this._upsertFile(n,t),c=new ge(s,this._context);return this._modules.push(c),c}update(e,t){let i=this._system.normalizePath(e),n=this._system.getAbsolutePath(i),o=this._modules.findIndex(l=>l.getSourcePath()===i);if(o<0)throw new Error("The file doesn't exist");let s=this._upsertFile(n,t),c=new ge(s,this._context);return this._modules.splice(o,1,c),c}getName(){return this._packageJson?.name??""}serialize(){return this._modules.map(e=>e.serialize())}_getPackageJSON(){let e=this._options.tsConfigFilePath?this._system.getDirectoryName(this._options.tsConfigFilePath):this._system.getCurrentDirectory(),t=this._system.join(e,"package.json"),i=this._system.fileExists(t)?this._system.readFile(t):null;try{return i!=null?JSON.parse(i):null}catch{return null}}_upsertFile(e,t){return this._system.writeFile(e,t),this._fileNames.has(e)||(this._commandLine=ye(this._system,this._options),this._fileNames.add(e)),this._program=fe.default.createProgram({rootNames:[...this._fileNames],options:this._program.getCompilerOptions(),host:this._compilerHost,oldProgram:this._program,projectReferences:this._program.getProjectReferences()??[]}),this._program.getSourceFile(e)}};async function ym(r,e={}){if(!r)return{project:null,errors:[{messageText:"Source code is empty."}]};let t;e.system?t=e.system:t=await(await import("./in-memory-system-JXWP2JVA.js")).InMemorySystem.create();let i=_t.fromSource(t,r,e),n=i.getDiagnostics();return{project:i,errors:n.getAll(),formattedDiagnostics:n.formatDiagnostics()}}export{ym as a};
